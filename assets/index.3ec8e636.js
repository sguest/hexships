var oe=Object.defineProperty,re=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var j=(t,e,i)=>e in t?oe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,H=(t,e)=>{for(var i in e||(e={}))ce.call(e,i)&&j(t,i,e[i]);if(J)for(var i of J(e))le.call(e,i)&&j(t,i,e[i]);return t},E=(t,e)=>re(t,ae(e));var T=(t,e,i)=>(j(t,typeof e!="symbol"?e+"":e,i),i);import{c as M,j as b,F as ie,a,r as u,R as he,b as de}from"./vendor.900b0ea6.js";const ue=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}};ue();const ge=M({heading:{fontFamily:["Big Shoulders Stencil Text","sans-serif"],color:"#ccc",fontSize:"3rem",margin:0,padding:{top:10,bottom:10,left:20}},menu:{margin:0,padding:{left:20},listStyleType:"none"},menuButton:{background:"transparent",border:"none",fontFamily:["Big Shoulders Stencil Text","sans-serif"],color:"#ccc",fontSize:"1.5rem",cursor:"pointer","&:hover":{color:"#fff"}}});function fe(t){const e=ge();return b(ie,{children:[a("h1",{className:e.heading,children:"Hexships"}),a("ul",{className:e.menu,children:a("li",{children:a("button",{className:e.menuButton,onClick:t.onNewGame,children:"New Game"})})})]})}const Z=Math.sqrt(3),C=20;function B(t){return{x:1.5*t.x*C,y:(t.y+.5*t.x)*C*Z}}function ne(t){const e=B(t);return[...Array(6).keys()].map(i=>{const n=Math.PI/3*i;return{x:e.x+C*Math.cos(n),y:e.y+C*Math.sin(n)}})}function me(t){return{x:t*3*C,y:t*2*C*Z}}function Se(t){const e=-t.x-t.y;let i=Math.round(t.x),n=Math.round(t.y);const s=Math.round(e),o=Math.abs(i-t.x),r=Math.abs(n-t.y),l=Math.abs(s-e);return o>r&&o>l?i=-n-s:r>l&&(n=-i-s),{x:i,y:n}}function ye(t){return Se({x:t.x*2/3/C,y:(t.x*-1/3+t.y*Z/3)/C})}function w(t,e){const i=-t.x-t.y;return t.x>-e&&t.x<e&&t.y>-e&&t.y<e&&i>-e&&i<e}function xe(t){const e=[];for(let i=-t+1;i<t;i++)for(let n=-t+1;n<t;n++)w({x:i,y:n},t)&&e.push({x:i,y:n});return e}function y(...t){const e={x:0,y:0};for(const i of t)e.x+=i.x,e.y+=i.y;return e}function z(t,e){return{x:t.x*e,y:t.y*e}}function N(t,e){return t.x===e.x&&t.y===e.y}function q(t,e){t.moveTo(e.x,e.y)}function _(t,e){t.lineTo(e.x,e.y)}function F(t,e,i){const n=t.current;if(!n)return;const s=n.getContext("2d");!s||(s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,n.width,n.height),s.scale(e,e),i(s))}const pe=M({canvas:{position:"absolute",zIndex:1,pointerEvents:"none"}});function be(t){const e=u.exports.useRef(null),i=pe();return u.exports.useEffect(()=>{F(e,t.uiScale,n=>{n.strokeStyle="black",n.beginPath();const s=xe(t.gridSize);for(const o of s){const r=ne(o);q(n,y(r[5],z(t.gridDimensions,.5)));for(const l of r)_(n,y(l,z(t.gridDimensions,.5)))}n.stroke()})},[t.gridSize,e,t.uiScale,t.gridDimensions]),a("canvas",{ref:e,width:t.gridDimensions.x*t.uiScale,height:t.gridDimensions.y*t.uiScale,className:i.canvas})}var P=(t=>(t[t.positiveX=0]="positiveX",t[t.positiveY=1]="positiveY",t[t.positiveZ=2]="positiveZ",t[t.negativeX=3]="negativeX",t[t.negativeY=4]="negativeY",t[t.negativeZ=5]="negativeZ",t))(P||{});const ve={[0]:{x:1,y:0},[1]:{x:0,y:1},[2]:{x:-1,y:1},[3]:{x:-1,y:0},[4]:{x:0,y:-1},[5]:{x:1,y:-1}};function D(t){return ve[t]}const ke=M({canvas:{position:"absolute",zIndex:3,pointerEvents:"none"}});function we(t){const e=u.exports.useRef(null),i=ke();return u.exports.useEffect(()=>{F(e,t.uiScale,n=>{n.strokeStyle="grey",n.lineWidth=C,n.lineCap="round",n.beginPath();for(const s of t.ships){const o=B(s),r=D(s.facing),l=y(s,z(r,s.size-1)),c=B(l);q(n,y(o,z(t.gridDimensions,.5))),_(n,y(c,z(t.gridDimensions,.5)))}n.stroke()})},[t.ships,e,t.uiScale,t.gridDimensions]),a("canvas",{ref:e,width:t.gridDimensions.x*t.uiScale,height:t.gridDimensions.y*t.uiScale,className:i.canvas})}var I=(t=>(t[t.Hit=0]="Hit",t[t.Miss=1]="Miss",t))(I||{});const ze=M({canvas:{position:"absolute",zIndex:4,pointerEvents:"none"}});function Me(t){const e=u.exports.useRef(null),i=ze();return u.exports.useEffect(()=>{F(e,t.uiScale,n=>{n.strokeStyle="black";for(const s of t.markers){n.fillStyle=s.type===I.Hit?"red":"white",n.beginPath();const o=y(B(s),z(t.gridDimensions,.5));n.arc(o.x,o.y,C*.4,0,Math.PI*2),n.stroke(),n.fill()}})},[t.markers,e,t.uiScale,t.gridDimensions]),a("canvas",{ref:e,width:t.gridDimensions.x*t.uiScale,height:t.gridDimensions.y*t.uiScale,className:i.canvas})}const Te=M({canvas:{position:"absolute",zIndex:2}});function Ce(t){const e=u.exports.useRef(null),[i,n]=u.exports.useState(null),[s,o]=u.exports.useState(void 0),r=Te();u.exports.useEffect(()=>{F(e,t.uiScale,h=>{const d=(m,v)=>{const O=ne(m);h.fillStyle=v,h.beginPath(),q(h,y(O[5],z(t.gridDimensions,.5)));for(const L of O)_(h,y(L,z(t.gridDimensions,.5)));h.fill()};if(i&&s&&d(i,s),t.highlightTiles)for(const m of t.highlightTiles)d(m,m.style)})},[e,t.highlightTiles,i,s,t.uiScale,t.gridDimensions]);const l=h=>{const d=h.target.getBoundingClientRect(),m=y(z({x:h.clientX,y:h.clientY},1/t.uiScale),z(t.gridDimensions,-.5),z(d,-1/t.uiScale));return ye(m)},c=h=>{const d=l(h);w(d,t.gridSize)&&t.onSelectTile&&t.onSelectTile(d)},f=h=>{const d=l(h);n(w(d,t.gridSize)?d:null),o(t.mouseHighlightStyle?t.mouseHighlightStyle(d):void 0)},p=()=>{n(null)};return a("canvas",{ref:e,width:t.gridDimensions.x*t.uiScale,height:t.gridDimensions.y*t.uiScale,className:r.canvas,onClick:c,onMouseMove:f,onMouseLeave:p})}const Pe=M({"@keyframes boardGradient":{from:{backgroundPosition:"0% 50%"},to:{backgroundPosition:"100% 50%"}},board:{animationName:"$boardGradient",animationDuration:"20s",animationIterationCount:"infinite",animationTimingFunction:"ease",animationDirection:"alternate",position:"relative",width:"100%",maxWidth:500,aspectRatio:.86,overflow:"hidden",background:"linear-gradient(80deg, #00545c 0%, #00405c 30%, #00545c 60%, #00405c 90%)",backgroundSize:"400% 400%",border:"5px solid #242f40"}});function X(t){var r,l;const e=u.exports.useRef(null),[i,n]=u.exports.useState(0),s=Pe();u.exports.useEffect(()=>{const c=()=>{var f;n((((f=e==null?void 0:e.current)==null?void 0:f.clientWidth)||0)/420)};return window.addEventListener("resize",c),c(),()=>{window.removeEventListener("resize",c)}},[e]);const o=me(t.gridSize);return b("div",{className:s.board,ref:e,children:[a(be,{gridSize:t.gridSize,uiScale:i,gridDimensions:o}),(!!((r=t.highlightTiles)==null?void 0:r.length)||t.onSelectTile||t.mouseHighlightStyle)&&a(Ce,{gridSize:t.gridSize,onSelectTile:t.onSelectTile,highlightTiles:t.highlightTiles,mouseHighlightStyle:t.mouseHighlightStyle,uiScale:i,gridDimensions:o}),t.ships&&a(we,{ships:t.ships,uiScale:i,gridDimensions:o}),!!((l=t.markers)==null?void 0:l.length)&&a(Me,{markers:t.markers,uiScale:i,gridDimensions:o})]})}function Y(t){const e=D(t.facing);let i={x:t.x,y:t.y};const n=[{x:t.x,y:t.y}];for(let s=1;s<t.size;s++)i=y(i,e),n.push(i);return n}function se(t,e,i){const n=Y(t),s=e.map(o=>Y(o)).flat();for(const o of n){if(!w(o,i))return!1;for(const r of s)if(N(o,r))return!1}return!0}function K(t,e){for(let i=0;i<t.length;i++)if(!se(t[i],t.slice(i+1),e))return!1;return!0}const A=750,Ne=M({container:{display:"inline-block",padding:10,[`@media (max-width: ${A}px)`]:{width:"100%"}},panel:{margin:0,padding:0,listStyleType:"none",width:"100%"},shipList:{width:"100%",display:"flex",flexDirection:"column",alignItems:"stretch",[`@media (max-width: ${A}px)`]:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",width:"100%"}},ship:{border:"2px solid black",background:"transparent",color:"#ccc",cursor:"pointer",width:220,textAlign:"left",boxSizing:"border-box",margin:{bottom:5},padding:{left:10,right:10,top:5,bottom:5},"& div":{fontSize:"1.5rem"},"& span":{fontSize:"1rem",display:"inline-block"}},selectedShip:{backgroundColor:"#0050d4"},placedShip:{borderColor:"#ccc"},actionContainer:{display:"flex",justifyContent:"space-between"},actionButton:{border:"1px solid black",color:"#ccc",background:"#0050d4",fontSize:"1.5rem",cursor:"pointer","&:first-of-type":{marginRight:20},"&:disabled":{cursor:"default",background:"#999"},[`@media (max-width: ${A}px)`]:{alignSelf:"stretch"}}});function Ie(t){const e=Ne();return b("div",{className:e.container,children:[a("div",{className:e.shipList,children:t.ships.map(i=>b("button",{onClick:()=>t.onSelected(i.id),className:`${e.ship} ${i.id===t.selectedId?e.selectedShip:""} ${t.placedIds.indexOf(i.id)===-1?"":e.placedShip}`,children:[a("div",{children:i.name}),b("span",{children:["Size: ",i.size]})]},i.id))}),b("div",{className:e.actionContainer,children:[a("button",{className:e.actionButton,onClick:t.onRotated,disabled:!t.canRotate,children:"Rotate"}),a("button",{className:e.actionButton,onClick:t.onPlace,disabled:!t.placementValid,children:"Confirm"})]})]})}const He=M({wrapper:{display:"flex",flexWrap:"wrap"}});function Oe(t){const[e,i]=u.exports.useState([]),[n,s]=u.exports.useState(void 0),[o,r]=u.exports.useState(void 0),l=He(),c=Object.values(e);(n==null?void 0:n.ship)&&c.push(n.ship);const f=!!(n==null?void 0:n.ship)&&se(n.ship,Object.values(e),t.gameSettings.gridSize),p=c.length===t.gameSettings.ships.length&&K(c,t.gameSettings.gridSize),h=f?"green":"red",d=o?[{x:o.x,y:o.y,style:h}]:[],m=S=>{if(S!==(n==null?void 0:n.id)){const x=H({},e);(n==null?void 0:n.ship)&&(x[n.id]=n.ship),e[S]?(s({id:S,ship:e[S]}),r(e[S]),delete x[S]):(s({id:S,ship:void 0}),r(void 0)),i(x)}},v=()=>{(n==null?void 0:n.ship)&&s({id:n.id,ship:E(H({},n.ship),{facing:(n.ship.facing+1)%6})})},O=()=>{p&&t.onShipsPlaced(c)},L=S=>{if(n){if(n.ship)s({id:n.id,ship:E(H({},n.ship),{x:S.x,y:S.y})});else{const x=t.gameSettings.ships.find(R=>R.id===n.id);x&&s({id:n.id,ship:{x:S.x,y:S.y,size:x.size,facing:P.positiveX,hits:0,name:x.name,definitionId:x.id}})}r(S)}},G=()=>(n==null?void 0:n.id)?"orange":void 0;return b("div",{className:l.wrapper,children:[a(X,{gridSize:t.gameSettings.gridSize,ships:c,onSelectTile:L,highlightTiles:d,mouseHighlightStyle:G}),a(Ie,{ships:t.gameSettings.ships,placedIds:Object.keys(e).map(Number),selectedId:n==null?void 0:n.id,placementValid:p,canRotate:!!n,onSelected:m,onRotated:v,onPlace:O})]})}const Q={fontSize:"1.6rem",border:"2px solid black",padding:{top:4,bottom:4,left:10,right:10},cursor:"pointer"},Ee=M({background:{position:"fixed",width:"100%",height:"100%",background:"rgba(50, 50, 50, 0.6)",zIndex:99},dialog:{border:"3px solid #ccc",display:"inline-block",background:"#333",color:"white",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:20,fontSize:"1.5rem",fontFamily:"sans-serif"},buttonContainer:{display:"flex",justifyContent:"space-between"},okButton:E(H({},Q),{"&:hover":{backgroundColor:"white"}}),cancelButton:E(H({},Q),{color:"#ccc",backgroundColor:"#333","&:hover":{backgroundColor:"#555"}})});function De(t){const e=Ee();return a("div",{className:e.background,children:b("div",{className:e.dialog,children:[a("p",{children:t.text}),b("div",{className:e.buttonContainer,children:[a("button",{className:e.okButton,onClick:t.onOk,children:"OK"}),a("button",{className:e.cancelButton,onClick:t.onCancel,children:"Cancel"})]})]})})}const Le=M({wrapper:{display:"flex",flexWrap:"wrap"},menuButton:{position:"absolute",left:10,top:10,zIndex:10,border:"2px solid white",background:"#333",color:"#ccc",fontSize:"1rem"},statusPanel:{position:"relative",padding:{top:10,left:10,right:10,bottom:60},minHeight:90,width:"100%",maxWidth:200},info:{fontFamily:["Big Shoulders Stencil Text","sans-serif"],color:"#ccc",fontSize:"2rem",margin:0},enemyShipHeader:{fontFamily:["Big Shoulders Stencil Text","sans-serif"],color:"#ccc",fontSize:"1.6rem",margin:{top:10,bottom:0}},enemyShip:{border:"2px solid black",color:"#ccc",fontFamily:"sans-serif",fontSize:"1.2rem",position:"relative",padding:4,margin:{top:5}},enemyShipSunk:{border:"2px solid red","&:after":{width:"100%",height:"100%",display:"inline-block",position:"absolute",top:0,left:0,content:'""',background:"linear-gradient(10deg, transparent 47%, red 47%, red 53%, transparent 53%), linear-gradient(170deg, transparent 47%, red 47%, red 53%, transparent 53%)"}},fire:{border:"2px solid #ccc",cursor:"pointer",color:"white",fontSize:"1.5rem",textShadow:"1px 1px 0 black",background:"radial-gradient(#ff8000, #ff0000)",textTransform:"uppercase",position:"absolute",bottom:10,left:10,"&:hover":{background:"radial-gradient(#ffa447, #ff4747)"},"&:disabled":{color:"#aaa",background:"#777",cursor:"default"}}});function Re(t){const[e,i]=u.exports.useState(void 0),[n,s]=u.exports.useState(0),[o,r]=u.exports.useState(void 0),[l,c]=u.exports.useState(!1),f=Le();u.exports.useEffect(()=>{const g=k=>{var U;i(E(H({},k),{ownMarkers:k.ownMarkers.slice(0),opponentMarkers:k.opponentMarkers.slice(0),ownShips:k.ownShips.slice(0),isOwnTurn:k.isOwnTurn,sunkEnemies:k.sunkEnemies.slice(0)}));let W=0;k.gameWon||k.gameLost?W=2:((U=k.ownShips)==null?void 0:U.length)&&(W=1),s(W)};return t.gameInterface.onStateChange(g),()=>{t.gameInterface.offStateChange(g)}},[t.gameInterface,e]);const p=g=>{t.gameInterface.setShips(g)},h=g=>!(e==null?void 0:e.ownMarkers.some(k=>N(g,k))),d=(e==null?void 0:e.isOwnTurn)&&n===1,m=g=>{d&&h(g)&&r(g)},v=g=>d&&h(g)?"orange":void 0,O=()=>{o&&h(o)&&(t.gameInterface.fireShot(o),r(void 0))},L=()=>{c(!0)},G=()=>{c(!1)},S=e==null?void 0:e.opponentMarkers[(e==null?void 0:e.opponentMarkers.length)-1];let x;n===1?x=(e==null?void 0:e.isOwnTurn)?"Take your shot":"Enemy's turn":n===2&&(x=`You have ${(e==null?void 0:e.gameWon)?"Won":"Lost"}`);let R;return(e==null?void 0:e.gameWon)?R=e.ownMarkers.filter(g=>g.type===I.Hit).map(g=>({x:g.x,y:g.y,style:"red"})):o&&(R=[{x:o.x,y:o.y,style:"red"}]),b(ie,{children:[l&&a(De,{text:"Are you sure you want to end the game?",onOk:t.onExit,onCancel:G}),a("button",{className:f.menuButton,onClick:L,children:"Return to Menu"}),n===0?a(Oe,{gameSettings:t.gameSettings,onShipsPlaced:p}):b("div",{className:f.wrapper,children:[a(X,{gridSize:t.gameSettings.gridSize,ships:e==null?void 0:e.ownShips,markers:e==null?void 0:e.opponentMarkers,highlightTiles:S?[{x:S.x,y:S.y,style:"orange"}]:void 0}),a(X,{gridSize:t.gameSettings.gridSize,ships:e==null?void 0:e.opponentShips,markers:e==null?void 0:e.ownMarkers,onSelectTile:m,highlightTiles:R,mouseHighlightStyle:v}),b("div",{className:f.statusPanel,children:[x&&a("p",{className:f.info,children:x}),a("p",{className:f.enemyShipHeader,children:"Enemy Ships"}),a("div",{children:t.gameSettings.ships.map(g=>a("div",{className:`${f.enemyShip} ${(e==null?void 0:e.sunkEnemies.indexOf(g.id))!==-1?f.enemyShipSunk:""}`,children:g.name},g.id))}),n===1&&a("button",{className:f.fire,onClick:O,disabled:!o||!(e==null?void 0:e.isOwnTurn),children:"Fire"})]})]})]})}class $e{constructor(e,i){T(this,"players");T(this,"activePlayerId");this.gameSettings=e,this.subscriber=i,this.players=[{ships:[],markers:[]},{ships:[],markers:[]}],this.activePlayerId=0}getLocalState(e){const i=+!e,n=this.playerLost(i),s=this.playerLost(e),o=s||n;return{ownShips:this.players[e].ships,ownMarkers:this.players[e].markers,opponentShips:o?this.players[i].ships:void 0,opponentMarkers:this.players[i].markers,isOwnTurn:e===this.activePlayerId&&!!this.players[e].ships.length,sunkEnemies:this.players[i].ships.filter(r=>r.hits===r.size).map(r=>r.definitionId),gameWon:n,gameLost:s}}playerLost(e){return this.players[e].ships.every(i=>i.hits===i.size)}validateShipPlacement(e){if(!K(e,this.gameSettings.gridSize))return[];const i=this.gameSettings.ships.slice(0),n=[];for(const s of e){const o=i.findIndex(r=>r.name===s.name&&r.size===s.size);if(o===-1)return[];n.push({x:s.x,y:s.y,size:s.size,facing:s.facing,hits:0,name:s.name,definitionId:s.definitionId}),i.splice(o,1)}return i.length?[]:n}setShips(e,i){const n=this.validateShipPlacement(i);n.length&&(this.players[e].ships=n),this.broadcastState()}fireShot(e,i){const n=+!e;if(this.activePlayerId===e&&w(i,this.gameSettings.gridSize)&&!this.players[e].markers.some(o=>N(o,i))&&!this.playerLost(e)&&!this.playerLost(n)){let o=!1;for(const r of this.players[n].ships)for(const l of Y(r))N(l,i)&&(o=!0,r.hits++);this.players[e].markers.push({x:i.x,y:i.y,type:o?I.Hit:I.Miss}),this.activePlayerId=n}this.broadcastState()}broadcastState(){for(let e=0;e<this.players.length;e++)this.subscriber(e,this.getLocalState(e))}}function $(t,e){return Math.floor(Math.random()*(e-t+1))+t}function Be(t){const e=Object.keys(t).map(s=>Number.parseInt(s)).filter(s=>!Number.isNaN(s)),i=Math.floor(Math.random()*e.length);return e[i]}class Fe{constructor(e){T(this,"ownShots",[]);T(this,"priorityHits",[]);T(this,"trackedHits",[]);T(this,"sunkShips",[]);this.gameSettings=e}generateShips(){const e=[],i=-this.gameSettings.gridSize,n=-this.gameSettings.gridSize,s=this.gameSettings.gridSize,o=this.gameSettings.gridSize;for(const r of this.gameSettings.ships){let l;do l={size:r.size,name:r.name,x:$(i,s),y:$(n,o),facing:Be(P),hits:0,definitionId:r.id};while(!K([...e,l],this.gameSettings.gridSize));e.push(l)}return e}updateState(e){var n,s;if(!((n=e.ownMarkers)==null?void 0:n.length))return;const i=e.ownMarkers[e.ownMarkers.length-1];if(this.ownShots[i.x]=this.ownShots[i.x]||[],this.ownShots[i.x][i.y]===void 0&&(this.ownShots[i.x][i.y]=i.type,i.type===I.Hit)){if(e.sunkEnemies.length===this.sunkShips.length)this.priorityHits.push(i),this.trackedHits.push(i);else for(const o of e.sunkEnemies)if(this.sunkShips.indexOf(o)===-1){this.sunkShips.push(o);const r=(s=this.gameSettings.ships.find(l=>l.id===o))==null?void 0:s.size;if(r){let l=!1;for(let c=0;c<6;c++)if(!l){const f=D(c);let p=i;const h=[p];for(let d=0;d<r;d++)p=y(p,f),this.trackedHits.find(v=>N(v,p))&&h.push(p);if(h.length===r){l=!0;for(const d of h){let m=this.trackedHits.findIndex(v=>N(v,d));m!==-1&&this.trackedHits.splice(m,1),m=this.priorityHits.findIndex(v=>N(v,d)),m!==-1&&this.priorityHits.splice(m,1)}}}}}}}getShot(){for(;this.priorityHits.length;){const i=this.priorityHits[0],n=[P.negativeX,P.negativeY,P.negativeZ,P.positiveX,P.positiveY,P.positiveZ];for(;n.length;){const o=n.splice($(0,n.length-1),1)[0];let r=D(o);const l=y(i,r);let c=i;if(this.trackedHits.find(f=>N(f,l))){for(;this.getOwnShot(c)===I.Hit&&w(c,this.gameSettings.gridSize);)c=y(c,r);if(this.getOwnShot(c)===void 0&&w(c,this.gameSettings.gridSize))return c;for(c=i,r=D((o+3)%6);this.getOwnShot(c)===I.Hit&&w(c,this.gameSettings.gridSize);)c=y(c,r);if(this.getOwnShot(c)===void 0&&w(c,this.gameSettings.gridSize))return c}}const s=[];for(let o=0;o<6;o++){const r=D(o),l=y(i,r);this.getOwnShot(l)===void 0&&w(l,this.gameSettings.gridSize)&&s.push(l)}if(s.length)return s[$(0,s.length-1)];this.priorityHits.splice(0,1)}const e=[];for(let i=-this.gameSettings.gridSize;i<=this.gameSettings.gridSize;i++)for(let n=-this.gameSettings.gridSize;n<=this.gameSettings.gridSize;n++){const s={x:i,y:n};w(s,this.gameSettings.gridSize)&&this.getOwnShot(s)===void 0&&e.push(s)}return e[$(0,e.length-1)]}getOwnShot(e){return this.ownShots[e.x]&&this.ownShots[e.x][e.y]}}const V=0,ee=1;class Ge{constructor(e){T(this,"stateSubscriptions");T(this,"gameManager");T(this,"aiPlayer");this.gameSettings=e,this.stateSubscriptions=[],this.gameManager=new $e(e,(i,n)=>this.sendState(i,n)),this.aiPlayer=new Fe(e)}onStateChange(e){this.stateSubscriptions.push(e)}offStateChange(e){const i=this.stateSubscriptions.indexOf(e);i>=0&&this.stateSubscriptions.splice(i,1)}setShips(e){this.gameManager.setShips(V,e),this.gameManager.setShips(ee,this.aiPlayer.generateShips())}fireShot(e){this.gameManager.fireShot(V,e)}sendState(e,i){e===V?this.stateSubscriptions.forEach(n=>n(i)):(this.aiPlayer.updateState(i),i.isOwnTurn&&!i.gameLost&&!i.gameWon&&setTimeout(()=>{this.takeEnemyShot()},1e3))}takeEnemyShot(){this.gameManager.fireShot(ee,this.aiPlayer.getShot())}}const te={gridSize:7,ships:[{id:1,size:2,name:"Patrol Boat"},{id:2,size:3,name:"Destroyer"},{id:3,size:3,name:"Submarine"},{id:4,size:4,name:"Battleship"},{id:5,size:5,name:"Aircraft Carrier"}]},We=M({container:{backgroundColor:"#022866",width:"100%",height:"100%",overflow:"auto"}});function je(){const[t,e]=u.exports.useState(null),i=We(),n=()=>{e(new Ge(te))},s=()=>{e(null)};return a("div",{className:i.container,children:t?a(Re,{gameInterface:t,gameSettings:te,onExit:s}):a(fe,{onNewGame:n})})}he.render(a(de.StrictMode,{children:a(je,{})}),document.getElementById("root"));
