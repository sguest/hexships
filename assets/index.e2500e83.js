var Fe=Object.defineProperty,Oe=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var be=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var ae=(e,t,i)=>t in e?Fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,b=(e,t)=>{for(var i in t||(t={}))Ee.call(t,i)&&ae(e,i,t[i]);if(be)for(var i of be(t))Re.call(t,i)&&ae(e,i,t[i]);return e},x=(e,t)=>Oe(e,Le(t));var P=(e,t,i)=>(ae(e,typeof t!="symbol"?t+"":t,i),i);import{c as N,j as g,R as ke,a as r,r as f,F as H,l as De,b as $e,d as Ge}from"./vendor.dc3d6da2.js";const Ae=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function i(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=i(o);fetch(o.href,n)}};Ae();var me=(e=>(e[e.positiveX=0]="positiveX",e[e.positiveY=1]="positiveY",e[e.positiveZ=2]="positiveZ",e[e.negativeX=3]="negativeX",e[e.negativeY=4]="negativeY",e[e.negativeZ=5]="negativeZ",e))(me||{});const We={[0]:{x:1,y:0},[1]:{x:0,y:1},[2]:{x:-1,y:1},[3]:{x:-1,y:0},[4]:{x:0,y:-1},[5]:{x:1,y:-1}};function R(e){return We[e]}function ve(){return[0,1,2,3,4,5]}function C(...e){const t={x:0,y:0};for(const i of e)t.x+=i.x,t.y+=i.y;return t}function B(e,t){return{x:e.x*t,y:e.y*t}}function w(e,t){return e.x===t.x&&e.y===t.y}function K(e,t){e.moveTo(t.x,t.y)}function U(e,t){e.lineTo(t.x,t.y)}const ge=Math.sqrt(3);function F(e){return 140/e}function X(e,t){return{x:1.5*e.x*F(t),y:(e.y+.5*e.x)*F(t)*ge}}function Ce(e,t){const i=X(e,t);return[...Array(6).keys()].map(s=>{const o=Math.PI/3*s;return{x:i.x+F(t)*Math.cos(o),y:i.y+F(t)*Math.sin(o)}})}function je(e){return{x:e*3*F(e),y:e*2*F(e)*ge}}function Ve(e){const t=-e.x-e.y;let i=Math.round(e.x),s=Math.round(e.y);const o=Math.round(t),n=Math.abs(i-e.x),a=Math.abs(s-e.y),l=Math.abs(o-t);return n>a&&n>l?i=-s-o:a>l&&(s=-i-o),{x:i,y:s}}function Xe(e,t){return Ve({x:e.x*2/3/F(t),y:(e.x*-1/3+e.y*ge/3)/F(t)})}function T(e,t){const i=-e.x-e.y;return e.x>-t&&e.x<t&&e.y>-t&&e.y<t&&i>-t&&i<t}function Ye(e){const t=[];for(let i=-e+1;i<e;i++)for(let s=-e+1;s<e;s++)T({x:i,y:s},e)&&t.push({x:i,y:s});return t}function qe(e,t){return ve().map(i=>{const s=R(i);return C(e,s)}).filter(i=>T(i,t))}function j(e){const t=R(e.facing);let i={x:e.x,y:e.y};const s=[{x:e.x,y:e.y}];for(let o=1;o<e.size;o++)i=C(i,t),s.push(i);return s}function we(e,t,i){const s=j(e),o=t.map(n=>j(n)).flat();for(const n of s){if(!T(n,i))return!1;for(const a of o)if(w(n,a))return!1}return!0}function ue(e,t){for(let i=0;i<e.length;i++)if(!we(e[i],e.slice(i+1),t))return!1;return!0}var I=(e=>(e[e.Hit=0]="Hit",e[e.Miss=1]="Miss",e))(I||{});function ze(e){return e.filter(t=>t.hits===t.size)}function fe(e,t){return e.shotPerShip?t.ownShips.length-ze(t.ownShips).length:e.shots}class Ze{constructor(t,i){P(this,"players");P(this,"activePlayerId");this.gameSettings=t,this.subscriber=i,this.players=[{ships:[],mines:[],markers:[],active:!0},{ships:[],mines:[],markers:[],active:!0}],this.activePlayerId=0}getLocalState(t){const i=+!t,s=this.playerLost(i),o=this.playerLost(t),n=o||s;return{ownShips:this.players[t].ships,ownMarkers:this.players[t].markers,ownMines:this.players[t].mines,opponentShips:n?this.players[i].ships:void 0,opponentMarkers:this.players[i].markers,opponentMines:this.players[i].mines.filter(a=>n||this.players[t].markers.some(l=>w(a,l))),isOwnTurn:t===this.activePlayerId&&!!this.players[t].ships.length,sunkEnemies:ze(this.players[i].ships).map(a=>a.definitionId),gameWon:s,gameLost:o,opponentShipsPlaced:!!this.players[i].ships.length,opponentLeft:!this.players[i].active}}playerLost(t){const i=this.players[t];return!i.active||!!i.ships.length&&i.ships.every(s=>s.hits===s.size)}validateShipPlacement(t){const i=this.gameSettings.ships.slice(0),s=[];for(const o of t){const n=i.findIndex(l=>l.id===o.definitionId);if(n===-1)return[];const a=i[n];s.push({x:o.x,y:o.y,size:a.size,facing:o.facing,hits:0,name:a.name,definitionId:o.definitionId}),i.splice(n,1)}return i.length?[]:ue(s,this.gameSettings.gridSize)?s:[]}validateMinePlacement(t,i){if(t.length!==this.gameSettings.mines)return!1;const s=i.map(o=>j(o)).flat();for(const o of t)if(s.some(n=>w(n,o))||t.some(n=>n!==o&&w(o,n))||!T(o,this.gameSettings.gridSize))return!1;return!0}setFleet(t,i){if(!this.players[t])return;const s=this.validateShipPlacement(i.ships);s.length&&this.validateMinePlacement(i.mines,s)?(this.players[t].ships=s,this.players[t].mines=i.mines.slice(),this.allShipsPlaced()?this.broadcastState():this.sendState(t)):this.sendState(t)}tryHit(t,i){for(const s of t)for(const o of j(s))if(w(o,i))return s.hits++,!0;return!1}fireShots(t,i){const s=this.players[t],o=this.getLocalState(t),n=+!t;if(this.activePlayerId===t&&!this.playerLost(t)&&!this.playerLost(n)&&this.allShipsPlaced()&&i.length===fe(this.gameSettings,o)&&i.every(l=>!!l&&T(l,this.gameSettings.gridSize)&&!s.markers.some(c=>w(c,l))&&!i.some(c=>c!==l&&w(l,c)))){let l=!1;for(const c of i){const d=this.tryHit(this.players[n].ships,c);if(s.markers.push({x:c.x,y:c.y,type:d?I.Hit:I.Miss}),l=l||d,this.players[n].mines.some(m=>w(m,c)))for(const m of[...qe(c,this.gameSettings.gridSize),c])this.players[n].markers.some(u=>w(u,m))||this.players[n].markers.push({x:m.x,y:m.y,type:this.tryHit(this.players[t].ships,m)?I.Hit:I.Miss})}(!this.gameSettings.streak||!l)&&(this.activePlayerId=n),this.broadcastState()}else this.sendState(t)}leaveGame(t){const i=+!t;!this.playerLost(t)&&!this.playerLost(i)&&(this.players[t].active=!1,this.broadcastState())}sendState(t){this.subscriber(t,this.getLocalState(t))}broadcastState(){for(let t=0;t<this.players.length;t++)this.sendState(t)}allShipsPlaced(){return this.players.every(t=>t.ships.length)}}function A(e,t){return Math.floor(Math.random()*(t-e+1))+e}function _e(e){const t=Object.keys(e).map(o=>Number.parseInt(o)).filter(o=>!Number.isNaN(o)),i=Math.floor(Math.random()*t.length);return t[i]}class Qe{constructor(t){P(this,"ownShots",[]);P(this,"ownShotCount",0);P(this,"priorityHits",[]);P(this,"trackedHits",[]);P(this,"sunkShips",[]);this.gameSettings=t}generateFleet(){const t=[],i=-this.gameSettings.gridSize,s=-this.gameSettings.gridSize,o=this.gameSettings.gridSize,n=this.gameSettings.gridSize;for(const c of this.gameSettings.ships){let d;do d={size:c.size,name:c.name,x:A(i,o),y:A(s,n),facing:_e(me),hits:0,definitionId:c.id};while(!ue([...t,d],this.gameSettings.gridSize));t.push(d)}const a=[],l=t.map(j).flat();for(let c=0;c<this.gameSettings.mines;c++){let d;do d={x:A(i,o),y:A(s,n)};while(!T(d,this.gameSettings.gridSize)||a.some(m=>w(m,d)||l.some(u=>w(u,d))));a.push(d)}return{ships:t,mines:a}}updateState(t){var i,s;if(!!((i=t.ownMarkers)==null?void 0:i.length))for(;t.ownMarkers.length>this.ownShotCount;){const o=t.ownMarkers[this.ownShotCount];if(this.ownShots[o.x]=this.ownShots[o.x]||[],this.ownShots[o.x][o.y]===void 0&&(this.ownShots[o.x][o.y]=o.type,o.type===I.Hit)){if(t.sunkEnemies.length===this.sunkShips.length)this.priorityHits.push(o),this.trackedHits.push(o);else for(const n of t.sunkEnemies)if(this.sunkShips.indexOf(n)===-1){this.sunkShips.push(n);const a=(s=this.gameSettings.ships.find(l=>l.id===n))==null?void 0:s.size;if(a){let l=!1;for(let c=0;c<6;c++)if(!l){const d=R(c);let m=o;const u=[m];for(let h=0;h<a;h++)m=C(m,d),this.trackedHits.find(p=>w(p,m))&&u.push(m);if(u.length===a){l=!0;for(const h of u){let S=this.trackedHits.findIndex(p=>w(p,h));S!==-1&&this.trackedHits.splice(S,1),S=this.priorityHits.findIndex(p=>w(p,h)),S!==-1&&this.priorityHits.splice(S,1)}}}}}}this.ownShotCount++}}getShots(t){const i=[];for(;this.priorityHits.length;){const a=this.priorityHits[0],l=ve();for(;l.length;){const d=l.splice(A(0,l.length-1),1)[0];let m=R(d);const u=C(a,m);let h=a;if(this.trackedHits.find(S=>w(S,u))){for(;this.getOwnShot(h)===I.Hit&&T(h,this.gameSettings.gridSize);)h=C(h,m);for(;this.getOwnShot(h)===void 0&&T(h,this.gameSettings.gridSize);)i.push(h),h=C(h,m);for(h=a,m=R((d+3)%6);this.getOwnShot(h)===I.Hit&&T(h,this.gameSettings.gridSize);)h=C(h,m);for(;this.getOwnShot(h)===void 0&&T(h,this.gameSettings.gridSize);)i.push(h),h=C(h,m)}}if(i.length>=t)return i.slice(0,t);const c=[];for(let d=0;d<6;d++){const m=R(d),u=C(a,m);this.getOwnShot(u)===void 0&&T(u,this.gameSettings.gridSize)&&c.push(u)}for(;c.length;)i.push(c.splice(A(0,c.length-1),1)[0]);if(i.length>=t)return i.slice(0,t);this.priorityHits.splice(0,1)}const s=this.gameSettings.ships.filter(a=>!this.sunkShips.some(l=>a.id===l)),o=Math.min(...s.map(a=>a.size)),n=[];for(let a=-this.gameSettings.gridSize;a<=this.gameSettings.gridSize;a++)for(let l=-this.gameSettings.gridSize;l<=this.gameSettings.gridSize;l++){const c={x:a,y:l};if(T(c,this.gameSettings.gridSize)&&this.getOwnShot(c)===void 0)for(let d=0;d<3;d++){const m=R(d);let u=!0;const h=[c];let S=c;for(let p=1;p<o;p++){S=C(S,m);const L=this.getOwnShot(S);!T(S,this.gameSettings.gridSize)||L===I.Miss?u=!1:L===void 0&&h.push(S)}u&&n.push(...h)}}for(;i.length<t;)i.push(n.splice(A(0,n.length-1),1)[0]);return i}getOwnShot(t){return this.ownShots[t.x]&&this.ownShots[t.x][t.y]}}const re=0,pe=1;class Ke{constructor(t){P(this,"stateSubscriptions");P(this,"gameManager");P(this,"aiPlayer");this.gameSettings=t,this.stateSubscriptions=[],this.gameManager=new Ze(t,(i,s)=>this.sendState(i,s)),this.aiPlayer=new Qe(t)}onStateChange(t){this.stateSubscriptions.push(t)}offStateChange(t){const i=this.stateSubscriptions.indexOf(t);i>=0&&this.stateSubscriptions.splice(i,1)}setFleet(t){this.gameManager.setFleet(re,t),this.gameManager.setFleet(pe,this.aiPlayer.generateFleet())}fireShots(t){this.gameManager.fireShots(re,t)}leaveGame(){}getSettings(){return this.gameSettings}sendState(t,i){t===re?this.stateSubscriptions.forEach(s=>s(i)):(this.aiPlayer.updateState(i),i.isOwnTurn&&!i.gameLost&&!i.gameWon&&setTimeout(()=>{this.takeEnemyShot(i)},1e3))}takeEnemyShot(t){this.gameManager.fireShots(pe,this.aiPlayer.getShots(fe(this.gameSettings,t)))}}function Ne(e){var t,i;if(!e.shotPerShip&&e.shots<1||e.mines<0||!((t=e.ships)==null?void 0:t.length))return!1;for(const s of e.ships)if(!((i=s.name)==null?void 0:i.trim())||s.size<1)return!1;return!0}const _={ships:[{id:1,size:2,name:"Patrol Boat"},{id:2,size:3,name:"Destroyer"},{id:3,size:3,name:"Submarine"},{id:4,size:4,name:"Battleship"},{id:5,size:5,name:"Aircraft Carrier"}],gridSize:7,streak:!1,shots:1,shotPerShip:!1,mines:0};var W=(e=>(e[e.Basic=0]="Basic",e[e.Streak=1]="Streak",e[e.Barrage=2]="Barrage",e[e.Salvo=3]="Salvo",e[e.Minefield=4]="Minefield",e[e.Custom=5]="Custom",e))(W||{});const Y={title:"Basic",id:0,description:"Basic rules with no modifications",settings:_},Ue={title:"Streak",id:1,description:"Fire again after landing a hit",settings:x(b({},_),{streak:!0})},Je={title:"Barrage",id:2,description:"Fire 4 shots each turn",settings:x(b({},_),{shots:4})},et={title:"Salvo",id:3,description:"Fire 1 shot for each surviving ship",settings:x(b({},_),{shotPerShip:!0})},tt={title:"Minefield",id:4,description:"Place 5 mines that explode when hit by the enemy, damaging enemy ships",settings:x(b({},_),{mines:5})},Me={title:"Custom",id:5,description:"Custom settings"},Te={[0]:Y,[1]:Ue,[2]:Je,[3]:et,[4]:tt,[5]:Me};function ce(e){return Te[e]}function Pe(){return Object.values(Te).filter(e=>!!e.settings)}const v="#ccc",q=["Big Shoulders Stencil Text","sans-serif"],Z={fontSize:"1.2rem",border:"2px solid black",padding:{top:4,bottom:4,left:10,right:10},cursor:"pointer",color:v,backgroundColor:"#333","&:hover":{backgroundColor:"#555"},"&:disabled":{cursor:"default",backgroundColor:"#999"}},de={border:`1px solid ${v}`,background:"transparent",color:v,padding:3,fontSize:"1rem","& option":{backgroundColor:"#022866"},"&:disabled":{backgroundColor:"#ccc",color:"#666"}},xe={fontSize:"1.6rem",border:"2px solid black",padding:{top:4,bottom:4,left:10,right:10},cursor:"pointer"},it=N({buttonContainer:{display:"flex",justifyContent:"space-between"},okButton:x(b({},xe),{"&:hover":{backgroundColor:"white"}}),cancelButton:x(b({},xe),{color:v,backgroundColor:"#333","&:hover":{backgroundColor:"#555"}})}),nt={content:{border:"3px solid #ccc",display:"inline-block",background:"#333",color:"white",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:20,fontSize:"1.5rem",fontFamily:"sans-serif",inset:"50% auto auto 50%"},overlay:{zIndex:999}};function Be(e){const t=it(),i=()=>{e.onClose(),e.onOk&&e.onOk()};return g(ke,{isOpen:!0,onRequestClose:e.onClose,style:nt,children:[typeof e.children=="string"?r("p",{children:e.children}):e.children,g("div",{className:t.buttonContainer,children:[e.okButton&&r("button",{className:t.okButton,onClick:i,children:"OK"}),e.cancelButton&&r("button",{className:t.cancelButton,onClick:e.onClose,children:"Cancel"})]})]})}const st=N({tooltip:{fontSize:"1.5rem",cursor:"pointer",marginLeft:"20px",color:"#cfc",border:"none",background:"transparent"}});function Se(e){const t=st(),[i,s]=f.exports.useState(!1);return g(H,{children:[i&&r(Be,{okButton:!0,onClose:()=>s(!1),children:e.children}),r("button",{className:t.tooltip,onClick:()=>s(!0),type:"button",children:"(?)"})]})}const ot=N({menu:{margin:0,padding:{left:20},listStyleType:"none"},menuButton:{background:"transparent",border:"none",fontFamily:q,color:v,fontSize:"1.5rem",cursor:"pointer","&:hover":{color:"#fff"}}});function at(e){const t=ot();return r("ul",{className:t.menu,children:e.items.filter(i=>i.condition===void 0||i.condition).map(i=>g("li",{children:[r("button",{className:t.menuButton,onClick:i.onClick,children:i.text}),i.tooltip&&r(Se,{children:i.tooltip})]},i.text))})}const rt=N({label:{color:v,fontSize:"1.1rem",fontFamily:"sans-serif",display:"flex",justifyContent:"space-between",alignItems:"flex-start",margin:{bottom:15}},input:x(b({},de),{width:200,boxSizing:"border-box",maxWidth:"100%",flexShrink:0}),checkbox:{width:20,height:20},addButton:{background:"transparent",border:"none",color:"green",fontSize:"1.5rem",cursor:"pointer",display:"block",marginBottom:10},deleteButton:{background:"transparent",border:"none",color:"red",fontSize:"1.1rem",cursor:"pointer"},shipsHeader:{color:v,fontSize:"1.4rem",fontFamily:"sans-serif"},shipList:{listStyleType:"none",padding:0,margin:0,color:v,fontFamily:"sans-serif",fontSize:"1.1rem","& li":{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},"& input":de},sizeInput:{maxWidth:100},nameInput:{marginRight:20}});function He(e){const t=rt(),i=n=>{const a=e.settings.ships.findIndex(c=>c.id===n.id),l=e.settings.ships.slice();l[a]=n,e.onSettingsChanged(x(b({},e.settings),{ships:l}))},s=()=>{e.onSettingsChanged(x(b({},e.settings),{ships:[...e.settings.ships,{id:Math.max(...e.settings.ships.map(n=>n.id))+1,name:"",size:2}]}))},o=n=>{const a=e.settings.ships.slice();a.splice(a.findIndex(l=>l.id===n),1),e.onSettingsChanged(x(b({},e.settings),{ships:a}))};return g(H,{children:[g("label",{className:t.label,children:["Number of shots per turn",r("input",{className:t.input,type:"number",min:"1",value:e.settings.shots,onChange:n=>e.onSettingsChanged(x(b({},e.settings),{shots:parseInt(n.target.value)})),disabled:e.settings.shotPerShip})]}),g("label",{className:t.label,children:["One shot per remaining ship",r("input",{className:t.checkbox,type:"checkbox",checked:e.settings.shotPerShip,onChange:n=>e.onSettingsChanged(x(b({},e.settings),{shotPerShip:n.target.checked}))})]}),g("label",{className:t.label,children:["Fire again on hit",r("input",{className:t.checkbox,type:"checkbox",checked:e.settings.streak,onChange:n=>e.onSettingsChanged(x(b({},e.settings),{streak:n.target.checked}))})]}),g("label",{className:t.label,children:["Number of mines",r("input",{className:t.input,type:"number",min:"0",value:e.settings.mines,onChange:n=>e.onSettingsChanged(x(b({},e.settings),{mines:parseInt(n.target.value)}))})]}),g("label",{className:t.label,children:["Field size - tiles from center to corner",r("input",{className:t.input,type:"number",min:"1",value:e.settings.gridSize,onChange:n=>e.onSettingsChanged(x(b({},e.settings),{gridSize:parseInt(n.target.value)}))})]}),r("p",{className:t.shipsHeader,children:"Ships"}),r("ul",{className:t.shipList,children:e.settings.ships.map(n=>g("li",{children:[g("label",{children:["Name ",r("input",{className:t.nameInput,type:"text",value:n.name,onChange:a=>i(x(b({},n),{name:a.target.value}))})]}),g("label",{children:["Size ",r("input",{className:t.sizeInput,type:"number",value:n.size,min:1,onChange:a=>i(x(b({},n),{size:parseInt(a.target.value)}))})]}),r("button",{className:t.deleteButton,type:"button",onClick:()=>o(n.id),children:"X"})]},n.id))}),r("button",{className:t.addButton,type:"button",onClick:s,children:"+"})]})}const lt=N({form:{padding:{left:20,right:20},maxWidth:500},label:{color:v,fontSize:"1.1rem",fontFamily:"sans-serif",display:"flex",justifyContent:"space-between",alignItems:"flex-start",margin:{bottom:15}},input:x(b({},de),{width:200,boxSizing:"border-box",maxWidth:"100%",flexShrink:0}),button:x(b({},Z),{"&:first-of-type":{marginRight:20}})});function ct(e){const t=lt(),[i,s]=f.exports.useState(W.Basic),[o,n]=f.exports.useState(Y.settings),[a,l]=f.exports.useState(""),c=()=>{var m,u;i===W.Custom?o&&((m=e.socket)==null||m.emit("add-custom-lobby-game",a,o),e.onCreated()):((u=e.socket)==null||u.emit("add-standard-lobby-game",a,i),e.onCreated())};let d=!0;return a.trim()||(d=!1),i===W.Custom&&!Ne(o)&&(d=!1),g("form",{className:t.form,children:[g("label",{className:t.label,children:["Game Name",r("input",{className:t.input,type:"text",value:a,onChange:m=>l(m.target.value)})]}),g("label",{className:t.label,children:["Game Mode",r(Se,{children:ce(i).description}),r("select",{className:t.input,value:i,onChange:m=>s(parseInt(m.target.value)),"data-testid":"gamemode",children:[...Pe(),Me].map(m=>r("option",{value:m.id,children:m.title},m.id))})]}),i===W.Custom&&r(H,{children:r(He,{onSettingsChanged:n,settings:o})}),r("button",{className:t.button,onClick:c,disabled:!d,type:"button",children:"Create"}),r("button",{className:t.button,onClick:()=>e.onCancel(),type:"button",children:"Cancel"})]})}const dt=N({item:{fontSize:"1rem",margin:{top:4,bottom:4}}});function ht(e){const t=dt(),i=(o,n)=>o.name===n.name&&o.size===n.size,s=e.settings.ships.length===5&&e.settings.ships.every((o,n)=>i(o,Y.settings.ships[n]));return g(H,{children:[r("p",{className:t.item,children:"Differences from basic rules:"}),e.settings.shotPerShip&&r("p",{className:t.item,children:"1 shot per surviving ship"}),!e.settings.shotPerShip&&e.settings.shots>1&&g("p",{className:t.item,children:[e.settings.shots," shots per turn"]}),e.settings.streak&&r("p",{className:t.item,children:"Fire again after a hit"}),e.settings.mines>0&&g("p",{className:t.item,children:[e.settings.mines," mine",e.settings.mines>1&&"s"]}),e.settings.gridSize!==Y.settings.gridSize&&g("p",{className:t.item,children:["Field size ",e.settings.gridSize," from center to corner"]}),!s&&g("div",{className:t.item,children:["Ships",r("ul",{children:e.settings.ships.map(o=>g("li",{children:[o.name," (size ",o.size,")"]},o.id))})]})]})}const mt=N({button:Z,noGamesMessage:{color:v,size:"2rem",fontFamily:"sans-serif",marginLeft:20},list:{listStyle:"none",padding:0,margin:20},game:{border:`1px solid ${v}`,padding:15,width:"100%",maxWidth:400,marginBottom:10},info:{margin:{top:0,bottom:5},color:v,fontSize:"1.2rem",fontFamily:"sans-serif"}});function gt(e){const t=mt(),[i,s]=f.exports.useState(void 0);f.exports.useEffect(()=>{var n;i===void 0&&((n=e.socket)==null||n.emit("enter-lobby",a=>{s(a)}))}),f.exports.useEffect(()=>{var n,a;return(n=e.socket)==null||n.on("add-lobby-game",l=>{i?i.findIndex(c=>c.id===l.id)===-1&&s([...i,l]):s([l])}),(a=e.socket)==null||a.on("remove-lobby-game",l=>{if(i){const c=i.findIndex(d=>d.id===l);if(c>=0){const d=i.slice();d.splice(c),s(d)}}}),()=>{var l,c;(l=e.socket)==null||l.removeAllListeners("add-lobby-game"),(c=e.socket)==null||c.removeAllListeners("remove-lobby-game")}},[e.socket,i]);const o=n=>{var a;(a=e.socket)==null||a.emit("join-lobby-game",n)};return g(H,{children:[!i&&r("p",{className:t.noGamesMessage,children:"Loading game list..."}),!!i&&!i.length&&r("p",{className:t.noGamesMessage,children:"No games found"}),!!(i==null?void 0:i.length)&&r("ul",{className:t.list,children:!!i&&i.map(n=>g("li",{className:t.game,children:[g("p",{className:t.info,children:["Name: ",n.definition.name]}),g("p",{className:t.info,children:["Mode: ",ce(n.definition.mode).title,r(Se,{children:n.definition.mode===W.Custom?r(ht,{settings:n.definition.settings}):ce(n.definition.mode).description})]}),r("button",{className:t.button,onClick:()=>o(n.id),children:"Join"})]},n.id))})]})}const ut=N({heading:{fontFamily:q,color:v,fontSize:"3rem",margin:0,padding:{top:10,bottom:10,left:20}},statusText:{fontFamily:q,color:v,fontSize:"1.5rem",padding:{left:20}},buttonStyle:x(b({},Z),{margin:{left:20}}),singlePlayerCustom:{padding:{left:20,right:20},maxWidth:500},playButton:Z});function ft(e){const t=ut(),[i,s]=f.exports.useState(0),[o,n]=f.exports.useState(Y.settings),{socket:a}=e,l=S=>{s(5),a==null||a.emit("quick-connect",S)},c=()=>{a==null||a.emit("cancel-quick-connect"),s(4)},d=()=>{a==null||a.emit("remove-lobby-game"),s(3)},m=S=>{e.onNewGame(new Ke(S))},u=S=>Pe().map(p=>({text:p.title,onClick:()=>S(p),tooltip:p.description}));let h=[];return i===0?h=[{text:"Versus AI",onClick:()=>s(1)},{text:"Multiplayer",onClick:()=>s(3),condition:e.isConnected}]:i===1?h=[...u(S=>m(S.settings)),{text:"Custom",onClick:()=>s(2)},{text:"Back",onClick:()=>s(0)}]:i===3?h=[{text:"Quick Match",onClick:()=>s(4)},{text:"Create Game",onClick:()=>s(6)},{text:"Find Game",onClick:()=>s(8)},{text:"Back",onClick:()=>s(0)}]:i===4&&(h=[...u(S=>l(S.id)),{text:"Back",onClick:()=>s(3)}]),g(H,{children:[r("h1",{className:t.heading,children:"Hexships"}),!!h.length&&r(at,{items:h}),i===2&&g("form",{className:t.singlePlayerCustom,children:[r(He,{onSettingsChanged:n,settings:o}),r("button",{className:t.playButton,onClick:()=>o&&m(o),disabled:!Ne(o),type:"button",children:"Play"}),r("button",{className:t.buttonStyle,onClick:()=>s(1),type:"button",children:"Cancel"})]}),i===5&&g(H,{children:[r("p",{className:t.statusText,children:"Searching for opponent..."}),r("button",{className:t.buttonStyle,onClick:c,children:"Cancel"})]}),i===6&&r(ct,{onCreated:()=>s(7),onCancel:()=>s(3),socket:a}),i===7&&g(H,{children:[r("p",{className:t.statusText,children:"Waiting for opponent..."}),r("button",{className:t.buttonStyle,onClick:d,children:"Cancel"})]}),i===8&&g(H,{children:[r("button",{className:t.buttonStyle,onClick:()=>s(3),children:"Back"}),r(gt,{socket:e.socket})]})]})}function J(e,t,i){const s=e.current;if(!s)return;const o=s.getContext("2d");!o||(o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,s.width,s.height),o.scale(t,t),i(o))}const St=N({"@keyframes boardGradient":{from:{backgroundPosition:"0% 50%"},to:{backgroundPosition:"100% 50%"}},canvas:{animationName:"$boardGradient",animationDuration:"20s",animationIterationCount:"infinite",animationTimingFunction:"ease",animationDirection:"alternate",position:"absolute",zIndex:1,pointerEvents:"none",background:"linear-gradient(80deg, #00545c 0%, #00405c 30%, #00545c 60%, #00405c 90%)",backgroundSize:"400% 400%",border:"5px solid #242f40",boxSizing:"border-box"}});function yt(e){const t=f.exports.useRef(null),i=St();return f.exports.useEffect(()=>{J(t,e.uiScale,s=>{s.strokeStyle="black",s.beginPath();const o=Ye(e.gridSize);for(const n of o){const a=Ce(n,e.gridSize);K(s,C(a[5],B(e.gridDimensions,.5)));for(const l of a)U(s,C(l,B(e.gridDimensions,.5)))}s.stroke()})},[e.gridSize,t,e.uiScale,e.gridDimensions]),r("canvas",{ref:t,width:e.gridDimensions.x*e.uiScale,height:e.gridDimensions.y*e.uiScale,className:i.canvas,"data-testid":"field-canvas"})}const bt=N({canvas:{position:"absolute",zIndex:3,pointerEvents:"none",border:"5px solid transparent",boxSizing:"border-box"}});function pt(e){const t=f.exports.useRef(null),i=bt();return f.exports.useEffect(()=>{J(t,e.uiScale,s=>{var o;s.strokeStyle="grey",s.lineWidth=F(e.gridSize),s.lineCap="round",s.beginPath();for(const n of e.ships){const a=X(n,e.gridSize),l=R(n.facing),c=C(n,B(l,n.size-1)),d=X(c,e.gridSize);K(s,C(a,B(e.gridDimensions,.5))),U(s,C(d,B(e.gridDimensions,.5)))}if(s.stroke(),(o=e.mines)==null?void 0:o.length){s.strokeStyle="black",s.fillStyle="black",s.lineWidth=1,s.lineCap="butt",s.beginPath();const n=16,a=Math.PI*2/n;for(const l of e.mines){const c=X(l,e.gridSize),d=[];for(let m=0;m<n;m++){const u=m*a,h=F(e.gridSize)*(m%2?.3:.8);d.push(C(c,{x:Math.cos(u)*h,y:Math.sin(u)*h},B(e.gridDimensions,.5)))}K(s,d[n-1]);for(const m of d)U(s,m)}s.fill()}})},[e.ships,e.mines,t,e.uiScale,e.gridDimensions,e.gridSize]),r("canvas",{ref:t,width:e.gridDimensions.x*e.uiScale,height:e.gridDimensions.y*e.uiScale,className:i.canvas,"data-testid":"ships-canvas"})}const xt=N({canvas:{position:"absolute",zIndex:4,pointerEvents:"none",border:"5px solid transparent",boxSizing:"border-box"}});function kt(e){const t=f.exports.useRef(null),i=xt();return f.exports.useEffect(()=>{J(t,e.uiScale,s=>{s.strokeStyle="black";for(const o of e.markers){s.fillStyle=o.type===I.Hit?"red":"white",s.beginPath();const n=C(X(o,e.gridSize),B(e.gridDimensions,.5));s.arc(n.x,n.y,F(e.gridSize)*.4,0,Math.PI*2),s.stroke(),s.fill()}})},[e.markers,t,e.uiScale,e.gridDimensions,e.gridSize]),r("canvas",{ref:t,width:e.gridDimensions.x*e.uiScale,height:e.gridDimensions.y*e.uiScale,className:i.canvas,"data-testid":"marker-canvas"})}const vt=N({canvas:{position:"absolute",zIndex:2,border:"5px solid transparent",boxSizing:"border-box"}});function Ct(e){const t=f.exports.useRef(null),[i,s]=f.exports.useState(null),[o,n]=f.exports.useState(void 0),a=vt();f.exports.useEffect(()=>{J(t,e.uiScale,u=>{const h=(S,p)=>{const L=Ce(S,e.gridSize);u.fillStyle=p,u.beginPath(),K(u,C(L[5],B(e.gridDimensions,.5)));for(const D of L)U(u,C(D,B(e.gridDimensions,.5)));u.fill()};if(e.overlayStyle&&(t==null?void 0:t.current)&&(u.fillStyle=e.overlayStyle,u.fillRect(0,0,999999,999999)),i&&o&&h(i,o),e.highlightTiles)for(const S of e.highlightTiles)h(S,S.style)})},[t,e.highlightTiles,i,o,e.uiScale,e.gridDimensions,e.overlayStyle,e.gridSize]);const l=u=>{const h=u.target.getBoundingClientRect(),S=C(B({x:u.clientX,y:u.clientY},1/e.uiScale),B(e.gridDimensions,-.5),B(h,-1/e.uiScale));return Xe(S,e.gridSize)},c=u=>{const h=l(u);T(h,e.gridSize)&&e.onSelectTile&&e.onSelectTile(h)},d=u=>{const h=l(u);s(T(h,e.gridSize)?h:null),n(e.mouseHighlightStyle?e.mouseHighlightStyle(h):void 0)},m=()=>{s(null)};return r("canvas",{ref:t,width:e.gridDimensions.x*e.uiScale,height:e.gridDimensions.y*e.uiScale,className:a.canvas,onClick:c,onMouseMove:d,onMouseLeave:m,"data-testid":"interaction-canvas"})}const wt=N({board:{position:"relative",width:"100%",maxHeight:"100%",aspectRatio:.86,overflow:"hidden","@media (max-width: 640px)":{maxWidth:"100%",height:"100%"},gridArea:e=>e.gridArea}});function he(e){var a,l;const t=f.exports.useRef(null),[i,s]=f.exports.useState(0),o=wt(e);f.exports.useEffect(()=>{const c=()=>{var d,m;s(Math.min((((d=t==null?void 0:t.current)==null?void 0:d.clientWidth)||0)/420,(((m=t==null?void 0:t.current)==null?void 0:m.clientHeight)||0)/500))};return window.addEventListener("resize",c),c(),()=>{window.removeEventListener("resize",c)}},[t]);const n=je(e.gridSize);return g("div",{className:o.board,ref:t,children:[r(yt,{gridSize:e.gridSize,uiScale:i,gridDimensions:n}),(!!((a=e.highlightTiles)==null?void 0:a.length)||e.onSelectTile||e.mouseHighlightStyle)&&r(Ct,{gridSize:e.gridSize,onSelectTile:e.onSelectTile,highlightTiles:e.highlightTiles,mouseHighlightStyle:e.mouseHighlightStyle,uiScale:i,gridDimensions:n,overlayStyle:e.overlayStyle}),!!(e.ships||e.mines)&&r(pt,{ships:e.ships||[],mines:e.mines||[],uiScale:i,gridDimensions:n,gridSize:e.gridSize}),!!((l=e.markers)==null?void 0:l.length)&&r(kt,{markers:e.markers,uiScale:i,gridDimensions:n,gridSize:e.gridSize})]})}const le=640,zt=N({container:{display:"inline-block",[`@media (max-width: ${le}px)`]:{width:"100%"}},panel:{margin:0,padding:0,listStyleType:"none",width:"100%"},shipList:{display:"grid",gridTemplateRows:"repeat(6, 1fr)",[`@media (max-width: ${le}px)`]:{gridTemplateRows:"repeat(2, 1fr)",gridTemplateColumns:"repeat(3, 1fr)"}},ship:{border:"2px solid black",background:"transparent",color:v,cursor:"pointer",textAlign:"left",boxSizing:"border-box",margin:{bottom:5},padding:{left:10,right:10,top:5,bottom:5},"@media (max-width: 560px)":{padding:{left:4,right:4,top:2,bottom:2}},"& div":{fontSize:"1.5rem","@media (max-width: 560px)":{fontSize:"1.1rem"}},"& span":{fontSize:"1rem",display:"inline-block","@media (max-width: 560px)":{fontSize:"0.8rem"}}},selectedShip:{backgroundColor:"#0050d4"},mines:{color:v,fontSize:"1.5rem",fontFamily:"sans-serif"},placedShip:{borderColor:v},actionContainer:{display:"flex",justifyContent:"space-between"},actionButton:x(b({},Z),{[`@media (max-width: ${le}px)`]:{alignSelf:"stretch",fontSize:"1rem"}})});function Nt(e){const t=zt();return g("div",{className:t.container,children:[e.mines===void 0?r("div",{className:t.shipList,children:e.ships.map(i=>g("button",{onClick:()=>e.onSelected(i.id),className:`${t.ship} ${i.id===e.selectedId?t.selectedShip:""} ${e.placedIds.indexOf(i.id)===-1?"":t.placedShip}`,children:[r("div",{children:i.name}),g("span",{children:["Size: ",i.size]})]},i.id))}):g("p",{className:t.mines,children:[e.mines," Mine",e.mines===1?"":"s"," remaining"]}),g("div",{className:t.actionContainer,children:[e.mines===void 0&&r("button",{className:t.actionButton,onClick:e.onRotated,disabled:!e.canRotate,children:"Rotate"}),r("button",{className:t.actionButton,onClick:e.onConfirm,disabled:!e.placementValid,children:"Confirm"})]})]})}const Mt=N({wrapper:{display:"grid",gridTemplateColumns:"5fr 1fr",gridTemplateRows:"100%",width:"100%",height:"100%",columnGap:"10px","@media (max-width: 640px)":{gridTemplateColumns:"100%",gridTemplateRows:"5fr 1fr",rowGap:"10px"}}});function Tt(e){const[t,i]=f.exports.useState([]),[s,o]=f.exports.useState([]),[n,a]=f.exports.useState(void 0),[l,c]=f.exports.useState(void 0),[d,m]=f.exports.useState(0),u=Mt(),h=Object.values(t);(n==null?void 0:n.ship)&&h.push(n.ship);const S=!!(n==null?void 0:n.ship)&&we(n.ship,Object.values(t),e.gameSettings.gridSize),p=d===0?h.length===e.gameSettings.ships.length&&ue(h,e.gameSettings.gridSize):s.length===e.gameSettings.mines,L=S?"green":"red",D=l?[{x:l.x,y:l.y,style:L}]:[],V=d===1?e.gameSettings.mines-s.length:void 0,$=k=>{if(k!==(n==null?void 0:n.id)){const M=b({},t);(n==null?void 0:n.ship)&&(M[n.id]=n.ship),t[k]?(a({id:k,ship:t[k]}),c(t[k]),delete M[k]):(a({id:k,ship:void 0}),c(void 0)),i(M)}},ee=()=>{(n==null?void 0:n.ship)&&a({id:n.id,ship:x(b({},n.ship),{facing:(n.ship.facing+1)%6})})},te=()=>{p&&(d===1||e.gameSettings.mines===0?e.onFleetPlaced({ships:h,mines:s}):(m(1),c(void 0)))},ie=k=>{if(n){if(n.ship)a({id:n.id,ship:x(b({},n.ship),{x:k.x,y:k.y})});else{const M=e.gameSettings.ships.find(O=>O.id===n.id);M&&a({id:n.id,ship:{x:k.x,y:k.y,size:M.size,facing:me.positiveX,hits:0,name:M.name,definitionId:M.id}})}c(k)}},ne=k=>{if(!h.map(j).flat().some(O=>w(O,k))){const O=s.findIndex(E=>w(E,k));if(O===-1)s.length<e.gameSettings.mines&&o([...s,k]);else{const E=[...s];E.splice(O,1),o(E)}}},se=k=>{d===0?ie(k):d===1&&ne(k)},oe=()=>(n==null?void 0:n.id)||d===1?"orange":void 0;return g("div",{className:u.wrapper,children:[r(he,{gridSize:e.gameSettings.gridSize,ships:h,mines:s,onSelectTile:se,highlightTiles:D,mouseHighlightStyle:oe}),r(Nt,{ships:e.gameSettings.ships,mines:V,placedIds:Object.keys(t).map(Number),selectedId:n==null?void 0:n.id,placementValid:p,canRotate:!!n,onSelected:$,onRotated:ee,onConfirm:te})]})}const Pt=N({statusPanel:{position:"relative",padding:{top:10,left:10,right:10,bottom:60},boxSizing:"border-box",minHeight:90,width:"100%",maxWidth:200,gridArea:"panel","@media (max-width: 640px)":{padding:0},display:"grid",gridTemplateColumns:"100%",gridTemplateRows:"repeat(7, 1fr)"},info:{fontFamily:q,color:v,fontSize:"2rem",margin:0,"@media (max-width: 640px)":{fontSize:"1rem"}},enemyShipHeader:{fontFamily:q,color:v,fontSize:"1.6rem",margin:{top:10,bottom:0},"@media (max-width: 640px)":{fontSize:"0.8rem"}},enemyShips:{display:"grid",gridTemplateColumns:"100%",gridTemplateRows:"repeat(6, 1fr)","@media (max-width: 640px)":{gridTemplateColumns:"1fr 1fr",gridTemplateRows:"repeat(3, 1fr)"}},enemyShip:{border:"2px solid black",color:v,fontFamily:"sans-serif",fontSize:"1.2rem",position:"relative",padding:4,margin:{top:5},"@media (max-width: 640px)":{fontSize:"0.6rem",padding:2}},enemyShipSunk:{border:"2px solid red","&:after":{width:"100%",height:"100%",display:"inline-block",position:"absolute",top:0,left:0,content:'""',background:"linear-gradient(10deg, transparent 47%, red 47%, red 53%, transparent 53%), linear-gradient(170deg, transparent 47%, red 47%, red 53%, transparent 53%)"}},fire:{border:"2px solid #ccc",cursor:"pointer",color:"white",fontSize:"1.5rem",textShadow:"1px 1px 0 black",background:"radial-gradient(#ff8000, #ff0000)",textTransform:"uppercase","&:hover":{background:"radial-gradient(#ffa447, #ff4747)"},"&:disabled":{color:"#aaa",background:"#777",cursor:"default"}},shotsRemaining:{color:v,fontFamily:"sans-serif",fontSize:"1.2rem","@media (max-width: 640px)":{fontSize:"0.6rem"}}});function Bt(e){var i;const t=Pt();return g("div",{className:t.statusPanel,children:[e.statusMessage&&r("p",{className:t.info,children:e.statusMessage}),((i=e.ships)==null?void 0:i.length)&&g(H,{children:[r("p",{className:t.enemyShipHeader,children:"Enemy Ships"}),g("div",{className:t.enemyShips,children:[e.ships.map(s=>g("div",{className:`${t.enemyShip} ${e.sunkShipIds&&e.sunkShipIds.indexOf(s.id)!==-1?t.enemyShipSunk:""}`,children:[s.name," (",s.size,")"]},s.id)),e.fireButtonVisible&&g(H,{children:[r("button",{className:t.fire,onClick:e.onFireClick,disabled:!e.fireButtonEnabled,children:"Fire"}),!!e.shotsRemaining&&g("p",{className:t.shotsRemaining,children:[e.shotsRemaining," shot",e.shotsRemaining===1?"":"s"," remaining"]})]})]})]})]})}const Ht=N({wrapper:{display:"grid",gridTemplateRows:"100%",gridTemplateColumns:"4fr 4fr 1fr",width:"100%",height:"100%",gridTemplateAreas:'"friend enemy panel"',"@media (max-width: 640px)":{gridTemplateColumns:"8fr 1fr",gridTemplateRows:"4fr 3fr",gridTemplateAreas:'"enemy enemy" "friend panel"'}},menuButton:{position:"absolute",left:10,top:10,zIndex:10,border:"2px solid white",background:"#333",color:v,fontSize:"1rem"}});function It(e){const[t,i]=f.exports.useState(void 0),[s,o]=f.exports.useState(0),[n,a]=f.exports.useState([]),[l,c]=f.exports.useState(!1),[d,m]=f.exports.useState([]),[u,h]=f.exports.useState([]),S=Ht(),p=e.gameInterface.getSettings();f.exports.useEffect(()=>{const y=z=>{var ye;i(x(b({},z),{ownMarkers:z.ownMarkers.slice(0),opponentMarkers:z.opponentMarkers.slice(0),ownShips:z.ownShips.slice(0),isOwnTurn:z.isOwnTurn,sunkEnemies:z.sunkEnemies.slice(0)}));const G=z.opponentMarkers.length-d.length;G>0&&(h(z.opponentMarkers.slice(-G)),m([...z.opponentMarkers]));let Q=0;z.gameWon||z.gameLost?Q=3:((ye=z.ownShips)==null?void 0:ye.length)&&(z.opponentShipsPlaced?Q=2:Q=1),o(Q)};return e.gameInterface.onStateChange(y),()=>{e.gameInterface.offStateChange(y)}},[e.gameInterface,t,d.length]);const L=y=>{e.gameInterface.setFleet(y)},D=y=>!(t==null?void 0:t.ownMarkers.some(z=>w(y,z))),V=(t==null?void 0:t.isOwnTurn)&&s===2,$=t?fe(p,t):0,ee=y=>{if(V&&D(y)){const z=n.findIndex(G=>w(G,y));if(z===-1)$===1?a([y]):n.length<$&&a([...n,y]);else{const G=[...n];G.splice(z,1),a(G)}}},te=y=>V&&D(y)?"orange":void 0,ie=()=>{n.length===$&&n.every(y=>D(y))&&(e.gameInterface.fireShots(n),a([]))},ne=()=>{c(!0)},se=()=>{e.gameInterface.leaveGame(),e.onExit()},oe=()=>{c(!1)},k=u.map(y=>({x:y.x,y:y.y,style:"orange"}));let M;s===2?M=(t==null?void 0:t.isOwnTurn)?"Take your shot":"Enemy's turn":s===3?(t==null?void 0:t.opponentLeft)?M="Your opponent left":M=`You have ${(t==null?void 0:t.gameWon)?"Won":"Lost"}`:s===1&&(M="Enemy placing ships");let O;(t==null?void 0:t.gameWon)?O=t.ownMarkers.filter(y=>y.type===I.Hit).map(y=>({x:y.x,y:y.y,style:"red"})):O=n.map(y=>({x:y.x,y:y.y,style:"red"}));let E;(t==null?void 0:t.gameWon)?E="rgba(0, 255, 0, 0.3)":(t==null?void 0:t.gameLost)&&(E="rgba(255, 0, 0, 0.3)");const Ie=V&&(p.shots>1||p.shotPerShip)?$-n.length:void 0;return g(H,{children:[l&&r(Be,{onOk:se,onClose:oe,okButton:!0,cancelButton:!0,children:"Are you sure you want to end the game?"}),r("button",{className:S.menuButton,onClick:ne,children:"Menu"}),s===0?r(Tt,{gameSettings:p,onFleetPlaced:L}):g("div",{className:S.wrapper,children:[r(he,{gridSize:p.gridSize,ships:t==null?void 0:t.ownShips,mines:t==null?void 0:t.ownMines,markers:t==null?void 0:t.opponentMarkers,highlightTiles:k,gridArea:"friend",overlayStyle:E}),r(he,{gridSize:p.gridSize,ships:t==null?void 0:t.opponentShips,mines:t==null?void 0:t.opponentMines,markers:t==null?void 0:t.ownMarkers,onSelectTile:ee,highlightTiles:O,mouseHighlightStyle:te,gridArea:"enemy",overlayStyle:E}),r(Bt,{statusMessage:M,ships:s===1?void 0:p.ships,sunkShipIds:t==null?void 0:t.sunkEnemies,fireButtonVisible:s===2,fireButtonEnabled:!!(n.length===$&&(t==null?void 0:t.isOwnTurn)),shotsRemaining:Ie,onFireClick:ie})]})]})}class Ft{constructor(t,i){P(this,"stateSubscriptions");this.socket=t,this.gameSettings=i,this.stateSubscriptions=[],this.socket.on("update-state",s=>{this.stateSubscriptions.forEach(o=>o(s))})}onStateChange(t){this.stateSubscriptions.push(t)}offStateChange(t){const i=this.stateSubscriptions.indexOf(t);i>=0&&this.stateSubscriptions.splice(i,1)}setFleet(t){this.socket.emit("set-fleet",t)}fireShots(t){this.socket.emit("fire-shots",t)}leaveGame(){this.socket.emit("leave-game")}getSettings(){return this.gameSettings}}const Ot=N({container:{backgroundColor:"#022866",width:"100%",height:"100%",overflow:"auto"}});function Lt(){const[e,t]=f.exports.useState(null),[i,s]=f.exports.useState(!1),[o,n]=f.exports.useState(void 0),a=Ot();f.exports.useEffect(()=>{const d=De();n(d),d.on("connect",()=>{s(!0)})},[]);const l=d=>{t(d)};f.exports.useEffect(()=>(o==null||o.on("join-game",d=>{l(new Ft(o,d))}),()=>{o==null||o.removeAllListeners("join-game")}),[o]);const c=()=>{t(null)};return r("div",{className:a.container,children:e?r(It,{gameInterface:e,onExit:c}):r(ft,{onNewGame:l,socket:o,isConnected:i})})}ke.setAppElement("#root");$e.render(r(Ge.StrictMode,{children:r(Lt,{})}),document.getElementById("root"));
