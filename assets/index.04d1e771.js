var ae=Object.defineProperty,ce=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var X=(t,e,i)=>e in t?ae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,O=(t,e)=>{for(var i in e||(e={}))de.call(e,i)&&X(t,i,e[i]);if(te)for(var i of te(e))he.call(e,i)&&X(t,i,e[i]);return t},R=(t,e)=>ce(t,le(e));var z=(t,e,i)=>(X(t,typeof e!="symbol"?e+"":e,i),i);import{c as C,r as u,j as y,F as A,a as c,l as ge,R as ue,b as me}from"./vendor.c09ed4ac.js";const fe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}};fe();var P=(t=>(t[t.positiveX=0]="positiveX",t[t.positiveY=1]="positiveY",t[t.positiveZ=2]="positiveZ",t[t.negativeX=3]="negativeX",t[t.negativeY=4]="negativeY",t[t.negativeZ=5]="negativeZ",t))(P||{});const Se={[0]:{x:1,y:0},[1]:{x:0,y:1},[2]:{x:-1,y:1},[3]:{x:-1,y:0},[4]:{x:0,y:-1},[5]:{x:1,y:-1}};function E(t){return Se[t]}function p(...t){const e={x:0,y:0};for(const i of t)e.x+=i.x,e.y+=i.y;return e}function T(t,e){return{x:t.x*e,y:t.y*e}}function I(t,e){return t.x===e.x&&t.y===e.y}function Q(t,e){t.moveTo(e.x,e.y)}function K(t,e){t.lineTo(e.x,e.y)}const U=Math.sqrt(3),M=20;function F(t){return{x:1.5*t.x*M,y:(t.y+.5*t.x)*M*U}}function oe(t){const e=F(t);return[...Array(6).keys()].map(i=>{const n=Math.PI/3*i;return{x:e.x+M*Math.cos(n),y:e.y+M*Math.sin(n)}})}function ye(t){return{x:t*3*M,y:t*2*M*U}}function pe(t){const e=-t.x-t.y;let i=Math.round(t.x),n=Math.round(t.y);const s=Math.round(e),o=Math.abs(i-t.x),r=Math.abs(n-t.y),a=Math.abs(s-e);return o>r&&o>a?i=-n-s:r>a&&(n=-i-s),{x:i,y:n}}function xe(t){return pe({x:t.x*2/3/M,y:(t.x*-1/3+t.y*U/3)/M})}function v(t,e){const i=-t.x-t.y;return t.x>-e&&t.x<e&&t.y>-e&&t.y<e&&i>-e&&i<e}function be(t){const e=[];for(let i=-t+1;i<t;i++)for(let n=-t+1;n<t;n++)v({x:i,y:n},t)&&e.push({x:i,y:n});return e}function Z(t){const e=E(t.facing);let i={x:t.x,y:t.y};const n=[{x:t.x,y:t.y}];for(let s=1;s<t.size;s++)i=p(i,e),n.push(i);return n}function re(t,e,i){const n=Z(t),s=e.map(o=>Z(o)).flat();for(const o of n){if(!v(o,i))return!1;for(const r of s)if(I(o,r))return!1}return!0}function J(t,e){for(let i=0;i<t.length;i++)if(!re(t[i],t.slice(i+1),e))return!1;return!0}var N=(t=>(t[t.Hit=0]="Hit",t[t.Miss=1]="Miss",t))(N||{});class ke{constructor(e,i){z(this,"players");z(this,"activePlayerId");this.gameSettings=e,this.subscriber=i,this.players=[{ships:[],markers:[],active:!0},{ships:[],markers:[],active:!0}],this.activePlayerId=0}getLocalState(e){const i=+!e,n=this.playerLost(i),s=this.playerLost(e),o=s||n;return{ownShips:this.players[e].ships,ownMarkers:this.players[e].markers,opponentShips:o?this.players[i].ships:void 0,opponentMarkers:this.players[i].markers,isOwnTurn:e===this.activePlayerId&&!!this.players[e].ships.length,sunkEnemies:this.players[i].ships.filter(r=>r.hits===r.size).map(r=>r.definitionId),gameWon:n,gameLost:s,opponentShipsPlaced:!!this.players[i].ships.length,opponentLeft:!this.players[i].active}}playerLost(e){const i=this.players[e];return!i.active||!!i.ships.length&&i.ships.every(n=>n.hits===n.size)}validateShipPlacement(e){if(!J(e,this.gameSettings.gridSize))return[];const i=this.gameSettings.ships.slice(0),n=[];for(const s of e){const o=i.findIndex(r=>r.name===s.name&&r.size===s.size);if(o===-1)return[];n.push({x:s.x,y:s.y,size:s.size,facing:s.facing,hits:0,name:s.name,definitionId:s.definitionId}),i.splice(o,1)}return i.length?[]:n}setShips(e,i){const n=this.validateShipPlacement(i);if(n.length){this.players[e].ships=n;const s=+!e;this.players[s].ships.length?this.broadcastState():this.subscriber(e,this.getLocalState(e))}}fireShot(e,i){const n=+!e;if(this.activePlayerId===e&&v(i,this.gameSettings.gridSize)&&!this.players[e].markers.some(o=>I(o,i))&&!this.playerLost(e)&&!this.playerLost(n)){let o=!1;for(const r of this.players[n].ships)for(const a of Z(r))I(a,i)&&(o=!0,r.hits++);this.players[e].markers.push({x:i.x,y:i.y,type:o?N.Hit:N.Miss}),this.activePlayerId=n}this.broadcastState()}leaveGame(e){const i=+!e;!this.playerLost(e)&&!this.playerLost(i)&&(this.players[e].active=!1,this.broadcastState())}broadcastState(){for(let e=0;e<this.players.length;e++)this.subscriber(e,this.getLocalState(e))}}function B(t,e){return Math.floor(Math.random()*(e-t+1))+t}function ve(t){const e=Object.keys(t).map(s=>Number.parseInt(s)).filter(s=>!Number.isNaN(s)),i=Math.floor(Math.random()*e.length);return e[i]}class we{constructor(e){z(this,"ownShots",[]);z(this,"priorityHits",[]);z(this,"trackedHits",[]);z(this,"sunkShips",[]);this.gameSettings=e}generateShips(){const e=[],i=-this.gameSettings.gridSize,n=-this.gameSettings.gridSize,s=this.gameSettings.gridSize,o=this.gameSettings.gridSize;for(const r of this.gameSettings.ships){let a;do a={size:r.size,name:r.name,x:B(i,s),y:B(n,o),facing:ve(P),hits:0,definitionId:r.id};while(!J([...e,a],this.gameSettings.gridSize));e.push(a)}return e}updateState(e){var n,s;if(!((n=e.ownMarkers)==null?void 0:n.length))return;const i=e.ownMarkers[e.ownMarkers.length-1];if(this.ownShots[i.x]=this.ownShots[i.x]||[],this.ownShots[i.x][i.y]===void 0&&(this.ownShots[i.x][i.y]=i.type,i.type===N.Hit)){if(e.sunkEnemies.length===this.sunkShips.length)this.priorityHits.push(i),this.trackedHits.push(i);else for(const o of e.sunkEnemies)if(this.sunkShips.indexOf(o)===-1){this.sunkShips.push(o);const r=(s=this.gameSettings.ships.find(a=>a.id===o))==null?void 0:s.size;if(r){let a=!1;for(let g=0;g<6;g++)if(!a){const h=E(g);let l=i;const d=[l];for(let m=0;m<r;m++)l=p(l,h),this.trackedHits.find(w=>I(w,l))&&d.push(l);if(d.length===r){a=!0;for(const m of d){let S=this.trackedHits.findIndex(w=>I(w,m));S!==-1&&this.trackedHits.splice(S,1),S=this.priorityHits.findIndex(w=>I(w,m)),S!==-1&&this.priorityHits.splice(S,1)}}}}}}}getShot(){for(;this.priorityHits.length;){const s=this.priorityHits[0],o=[P.negativeX,P.negativeY,P.negativeZ,P.positiveX,P.positiveY,P.positiveZ];for(;o.length;){const a=o.splice(B(0,o.length-1),1)[0];let g=E(a);const h=p(s,g);let l=s;if(this.trackedHits.find(d=>I(d,h))){for(;this.getOwnShot(l)===N.Hit&&v(l,this.gameSettings.gridSize);)l=p(l,g);if(this.getOwnShot(l)===void 0&&v(l,this.gameSettings.gridSize))return l;for(l=s,g=E((a+3)%6);this.getOwnShot(l)===N.Hit&&v(l,this.gameSettings.gridSize);)l=p(l,g);if(this.getOwnShot(l)===void 0&&v(l,this.gameSettings.gridSize))return l}}const r=[];for(let a=0;a<6;a++){const g=E(a),h=p(s,g);this.getOwnShot(h)===void 0&&v(h,this.gameSettings.gridSize)&&r.push(h)}if(r.length)return r[B(0,r.length-1)];this.priorityHits.splice(0,1)}const e=this.gameSettings.ships.filter(s=>!this.sunkShips.some(o=>s.id===o)),i=Math.min(...e.map(s=>s.size)),n=[];for(let s=-this.gameSettings.gridSize;s<=this.gameSettings.gridSize;s++)for(let o=-this.gameSettings.gridSize;o<=this.gameSettings.gridSize;o++){const r={x:s,y:o};if(v(r,this.gameSettings.gridSize)&&this.getOwnShot(r)===void 0)for(let a=0;a<3;a++){const g=E(a);let h=!0;const l=[r];let d=r;for(let m=1;m<i;m++){d=p(d,g);const S=this.getOwnShot(d);!v(d,this.gameSettings.gridSize)||S===N.Miss?h=!1:S===void 0&&l.push(d)}h&&n.push(...l)}}return n[B(0,n.length-1)]}getOwnShot(e){return this.ownShots[e.x]&&this.ownShots[e.x][e.y]}}const j=0,ie=1;class ze{constructor(e){z(this,"stateSubscriptions");z(this,"gameManager");z(this,"aiPlayer");this.gameSettings=e,this.stateSubscriptions=[],this.gameManager=new ke(e,(i,n)=>this.sendState(i,n)),this.aiPlayer=new we(e)}onStateChange(e){this.stateSubscriptions.push(e)}offStateChange(e){const i=this.stateSubscriptions.indexOf(e);i>=0&&this.stateSubscriptions.splice(i,1)}setShips(e){this.gameManager.setShips(j,e),this.gameManager.setShips(ie,this.aiPlayer.generateShips())}fireShot(e){this.gameManager.fireShot(j,e)}leaveGame(){}sendState(e,i){e===j?this.stateSubscriptions.forEach(n=>n(i)):(this.aiPlayer.updateState(i),i.isOwnTurn&&!i.gameLost&&!i.gameWon&&setTimeout(()=>{this.takeEnemyShot()},1e3))}takeEnemyShot(){this.gameManager.fireShot(ie,this.aiPlayer.getShot())}}class Te{constructor(e){z(this,"stateSubscriptions");this.socket=e,this.stateSubscriptions=[],this.socket.on("update-state",i=>{this.stateSubscriptions.forEach(n=>n(i))})}onStateChange(e){this.stateSubscriptions.push(e)}offStateChange(e){const i=this.stateSubscriptions.indexOf(e);i>=0&&this.stateSubscriptions.splice(i,1)}setShips(e){this.socket.emit("set-ships",e)}fireShot(e){this.socket.emit("fire-shot",e)}leaveGame(){this.socket.emit("leave-game")}}const Ce=C({heading:{fontFamily:["Big Shoulders Stencil Text","sans-serif"],color:"#ccc",fontSize:"3rem",margin:0,padding:{top:10,bottom:10,left:20}},menu:{margin:0,padding:{left:20},listStyleType:"none"},menuButton:{background:"transparent",border:"none",fontFamily:["Big Shoulders Stencil Text","sans-serif"],color:"#ccc",fontSize:"1.5rem",cursor:"pointer","&:hover":{color:"#fff"}},statusText:{fontFamily:["Big Shoulders Stencil Text","sans-serif"],color:"#ccc",fontSize:"1.5rem",padding:{left:20}},buttonStyle:{fontSize:"1.2rem",border:"2px solid black",padding:{top:4,bottom:4,left:10,right:10},margin:{left:20},cursor:"pointer",color:"#ccc",backgroundColor:"#333","&:hover":{backgroundColor:"#555"}}});function Me(t){const e=Ce(),[i,n]=u.exports.useState(!1),s=()=>{var r,a;n(!0),(r=t.socket)==null||r.once("quick-match-found",()=>{t.onNewGame(new Te(t.socket))}),(a=t.socket)==null||a.emit("quick-connect")},o=()=>{var r,a;(r=t.socket)==null||r.emit("cancel-quick-connect"),(a=t.socket)==null||a.off("quick-match-found"),n(!1)};return y(A,{children:[c("h1",{className:e.heading,children:"Hexships"}),i&&y(A,{children:[c("p",{className:e.statusText,children:"Searching for opponent..."}),c("button",{className:e.buttonStyle,onClick:o,children:"Cancel"})]}),!i&&y("ul",{className:e.menu,children:[c("li",{children:c("button",{className:e.menuButton,onClick:()=>t.onNewGame(new ze(t.gameSettings)),children:"Versus AI"})}),t.socket&&t.isConnected&&c("li",{children:c("button",{className:e.menuButton,onClick:s,children:"Find Opponent"})})]})]})}function V(t,e,i){const n=t.current;if(!n)return;const s=n.getContext("2d");!s||(s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,n.width,n.height),s.scale(e,e),i(s))}const Pe=C({"@keyframes boardGradient":{from:{backgroundPosition:"0% 50%"},to:{backgroundPosition:"100% 50%"}},canvas:{animationName:"$boardGradient",animationDuration:"20s",animationIterationCount:"infinite",animationTimingFunction:"ease",animationDirection:"alternate",position:"absolute",zIndex:1,pointerEvents:"none",background:"linear-gradient(80deg, #00545c 0%, #00405c 30%, #00545c 60%, #00405c 90%)",backgroundSize:"400% 400%",border:"5px solid #242f40",boxSizing:"border-box"}});function Ne(t){const e=u.exports.useRef(null),i=Pe();return u.exports.useEffect(()=>{V(e,t.uiScale,n=>{n.strokeStyle="black",n.beginPath();const s=be(t.gridSize);for(const o of s){const r=oe(o);Q(n,p(r[5],T(t.gridDimensions,.5)));for(const a of r)K(n,p(a,T(t.gridDimensions,.5)))}n.stroke()})},[t.gridSize,e,t.uiScale,t.gridDimensions]),c("canvas",{ref:e,width:t.gridDimensions.x*t.uiScale,height:t.gridDimensions.y*t.uiScale,className:i.canvas})}const He=C({canvas:{position:"absolute",zIndex:3,pointerEvents:"none",border:"5px solid transparent",boxSizing:"border-box"}});function Ie(t){const e=u.exports.useRef(null),i=He();return u.exports.useEffect(()=>{V(e,t.uiScale,n=>{n.strokeStyle="grey",n.lineWidth=M,n.lineCap="round",n.beginPath();for(const s of t.ships){const o=F(s),r=E(s.facing),a=p(s,T(r,s.size-1)),g=F(a);Q(n,p(o,T(t.gridDimensions,.5))),K(n,p(g,T(t.gridDimensions,.5)))}n.stroke()})},[t.ships,e,t.uiScale,t.gridDimensions]),c("canvas",{ref:e,width:t.gridDimensions.x*t.uiScale,height:t.gridDimensions.y*t.uiScale,className:i.canvas})}const Oe=C({canvas:{position:"absolute",zIndex:4,pointerEvents:"none",border:"5px solid transparent",boxSizing:"border-box"}});function Ee(t){const e=u.exports.useRef(null),i=Oe();return u.exports.useEffect(()=>{V(e,t.uiScale,n=>{n.strokeStyle="black";for(const s of t.markers){n.fillStyle=s.type===N.Hit?"red":"white",n.beginPath();const o=p(F(s),T(t.gridDimensions,.5));n.arc(o.x,o.y,M*.4,0,Math.PI*2),n.stroke(),n.fill()}})},[t.markers,e,t.uiScale,t.gridDimensions]),c("canvas",{ref:e,width:t.gridDimensions.x*t.uiScale,height:t.gridDimensions.y*t.uiScale,className:i.canvas})}const Le=C({canvas:{position:"absolute",zIndex:2,border:"5px solid transparent",boxSizing:"border-box"}});function Re(t){const e=u.exports.useRef(null),[i,n]=u.exports.useState(null),[s,o]=u.exports.useState(void 0),r=Le();u.exports.useEffect(()=>{V(e,t.uiScale,d=>{const m=(S,w)=>{const L=oe(S);d.fillStyle=w,d.beginPath(),Q(d,p(L[5],T(t.gridDimensions,.5)));for(const D of L)K(d,p(D,T(t.gridDimensions,.5)));d.fill()};if(t.overlayStyle&&(e==null?void 0:e.current)&&(d.fillStyle=t.overlayStyle,d.fillRect(0,0,999999,999999)),i&&s&&m(i,s),t.highlightTiles)for(const S of t.highlightTiles)m(S,S.style)})},[e,t.highlightTiles,i,s,t.uiScale,t.gridDimensions,t.overlayStyle]);const a=d=>{const m=d.target.getBoundingClientRect(),S=p(T({x:d.clientX,y:d.clientY},1/t.uiScale),T(t.gridDimensions,-.5),T(m,-1/t.uiScale));return xe(S)},g=d=>{const m=a(d);v(m,t.gridSize)&&t.onSelectTile&&t.onSelectTile(m)},h=d=>{const m=a(d);n(v(m,t.gridSize)?m:null),o(t.mouseHighlightStyle?t.mouseHighlightStyle(m):void 0)},l=()=>{n(null)};return c("canvas",{ref:e,width:t.gridDimensions.x*t.uiScale,height:t.gridDimensions.y*t.uiScale,className:r.canvas,onClick:g,onMouseMove:h,onMouseLeave:l})}const De=C({board:{position:"relative",width:"100%",maxHeight:"100%",aspectRatio:.86,overflow:"hidden","@media (max-width: 640px)":{maxWidth:"100%",height:"100%"},gridArea:t=>t.gridArea}});function _(t){var r,a;const e=u.exports.useRef(null),[i,n]=u.exports.useState(0),s=De(t);u.exports.useEffect(()=>{const g=()=>{var h,l;n(Math.min((((h=e==null?void 0:e.current)==null?void 0:h.clientWidth)||0)/420,(((l=e==null?void 0:e.current)==null?void 0:l.clientHeight)||0)/500))};return window.addEventListener("resize",g),g(),()=>{window.removeEventListener("resize",g)}},[e]);const o=ye(t.gridSize);return y("div",{className:s.board,ref:e,children:[c(Ne,{gridSize:t.gridSize,uiScale:i,gridDimensions:o}),(!!((r=t.highlightTiles)==null?void 0:r.length)||t.onSelectTile||t.mouseHighlightStyle)&&c(Re,{gridSize:t.gridSize,onSelectTile:t.onSelectTile,highlightTiles:t.highlightTiles,mouseHighlightStyle:t.mouseHighlightStyle,uiScale:i,gridDimensions:o,overlayStyle:t.overlayStyle}),t.ships&&c(Ie,{ships:t.ships,uiScale:i,gridDimensions:o}),!!((a=t.markers)==null?void 0:a.length)&&c(Ee,{markers:t.markers,uiScale:i,gridDimensions:o})]})}const q=640,Be=C({container:{display:"inline-block",[`@media (max-width: ${q}px)`]:{width:"100%"}},panel:{margin:0,padding:0,listStyleType:"none",width:"100%"},shipList:{display:"grid",gridTemplateRows:"repeat(6, 1fr)",[`@media (max-width: ${q}px)`]:{gridTemplateRows:"repeat(2, 1fr)",gridTemplateColumns:"repeat(3, 1fr)"}},ship:{border:"2px solid black",background:"transparent",color:"#ccc",cursor:"pointer",textAlign:"left",boxSizing:"border-box",margin:{bottom:5},padding:{left:10,right:10,top:5,bottom:5},"@media (max-width: 560px)":{padding:{left:4,right:4,top:2,bottom:2}},"& div":{fontSize:"1.5rem","@media (max-width: 560px)":{fontSize:"1.1rem"}},"& span":{fontSize:"1rem",display:"inline-block","@media (max-width: 560px)":{fontSize:"0.8rem"}}},selectedShip:{backgroundColor:"#0050d4"},placedShip:{borderColor:"#ccc"},actionContainer:{display:"flex",justifyContent:"space-between"},actionButton:{border:"1px solid black",color:"#ccc",background:"#0050d4",fontSize:"1.5rem",cursor:"pointer","&:first-of-type":{marginRight:20},"&:disabled":{cursor:"default",background:"#999"},[`@media (max-width: ${q}px)`]:{alignSelf:"stretch",fontSize:"1rem"}}});function $e(t){const e=Be();return y("div",{className:e.container,children:[c("div",{className:e.shipList,children:t.ships.map(i=>y("button",{onClick:()=>t.onSelected(i.id),className:`${e.ship} ${i.id===t.selectedId?e.selectedShip:""} ${t.placedIds.indexOf(i.id)===-1?"":e.placedShip}`,children:[c("div",{children:i.name}),y("span",{children:["Size: ",i.size]})]},i.id))}),y("div",{className:e.actionContainer,children:[c("button",{className:e.actionButton,onClick:t.onRotated,disabled:!t.canRotate,children:"Rotate"}),c("button",{className:e.actionButton,onClick:t.onPlace,disabled:!t.placementValid,children:"Confirm"})]})]})}const Ge=C({wrapper:{display:"grid",gridTemplateColumns:"5fr 1fr",gridTemplateRows:"100%",width:"100%",height:"100%",columnGap:"10px","@media (max-width: 640px)":{gridTemplateColumns:"100%",gridTemplateRows:"5fr 1fr",rowGap:"10px"}}});function Ae(t){const[e,i]=u.exports.useState([]),[n,s]=u.exports.useState(void 0),[o,r]=u.exports.useState(void 0),a=Ge(),g=Object.values(e);(n==null?void 0:n.ship)&&g.push(n.ship);const h=!!(n==null?void 0:n.ship)&&re(n.ship,Object.values(e),t.gameSettings.gridSize),l=g.length===t.gameSettings.ships.length&&J(g,t.gameSettings.gridSize),d=h?"green":"red",m=o?[{x:o.x,y:o.y,style:d}]:[],S=x=>{if(x!==(n==null?void 0:n.id)){const b=O({},e);(n==null?void 0:n.ship)&&(b[n.id]=n.ship),e[x]?(s({id:x,ship:e[x]}),r(e[x]),delete b[x]):(s({id:x,ship:void 0}),r(void 0)),i(b)}},w=()=>{(n==null?void 0:n.ship)&&s({id:n.id,ship:R(O({},n.ship),{facing:(n.ship.facing+1)%6})})},L=()=>{l&&t.onShipsPlaced(g)},D=x=>{if(n){if(n.ship)s({id:n.id,ship:R(O({},n.ship),{x:x.x,y:x.y})});else{const b=t.gameSettings.ships.find(H=>H.id===n.id);b&&s({id:n.id,ship:{x:x.x,y:x.y,size:b.size,facing:P.positiveX,hits:0,name:b.name,definitionId:b.id}})}r(x)}},W=()=>(n==null?void 0:n.id)?"orange":void 0;return y("div",{className:a.wrapper,children:[c(_,{gridSize:t.gameSettings.gridSize,ships:g,onSelectTile:D,highlightTiles:m,mouseHighlightStyle:W}),c($e,{ships:t.gameSettings.ships,placedIds:Object.keys(e).map(Number),selectedId:n==null?void 0:n.id,placementValid:l,canRotate:!!n,onSelected:S,onRotated:w,onPlace:L})]})}const ne={fontSize:"1.6rem",border:"2px solid black",padding:{top:4,bottom:4,left:10,right:10},cursor:"pointer"},Fe=C({background:{position:"fixed",width:"100%",height:"100%",background:"rgba(50, 50, 50, 0.6)",zIndex:99},dialog:{border:"3px solid #ccc",display:"inline-block",background:"#333",color:"white",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:20,fontSize:"1.5rem",fontFamily:"sans-serif"},buttonContainer:{display:"flex",justifyContent:"space-between"},okButton:R(O({},ne),{"&:hover":{backgroundColor:"white"}}),cancelButton:R(O({},ne),{color:"#ccc",backgroundColor:"#333","&:hover":{backgroundColor:"#555"}})});function Ve(t){const e=Fe();return c("div",{className:e.background,children:y("div",{className:e.dialog,children:[c("p",{children:t.text}),y("div",{className:e.buttonContainer,children:[c("button",{className:e.okButton,onClick:t.onOk,children:"OK"}),c("button",{className:e.cancelButton,onClick:t.onCancel,children:"Cancel"})]})]})})}const We=C({wrapper:{display:"grid",gridTemplateRows:"100%",gridTemplateColumns:"4fr 4fr 1fr",width:"100%",height:"100%",gridTemplateAreas:'"friend enemy panel"',"@media (max-width: 640px)":{gridTemplateColumns:"8fr 1fr",gridTemplateRows:"4fr 3fr",gridTemplateAreas:'"enemy enemy" "friend panel"'}},menuButton:{position:"absolute",left:10,top:10,zIndex:10,border:"2px solid white",background:"#333",color:"#ccc",fontSize:"1rem"},statusPanel:{position:"relative",padding:{top:10,left:10,right:10,bottom:60},boxSizing:"border-box",minHeight:90,width:"100%",maxWidth:200,gridArea:"panel","@media (max-width: 640px)":{padding:0},display:"grid",gridTemplateColumns:"100%",gridTemplateRows:"repeat(7, 1fr)"},info:{fontFamily:["Big Shoulders Stencil Text","sans-serif"],color:"#ccc",fontSize:"2rem",margin:0,"@media (max-width: 640px)":{fontSize:"1rem"}},enemyShipHeader:{fontFamily:["Big Shoulders Stencil Text","sans-serif"],color:"#ccc",fontSize:"1.6rem",margin:{top:10,bottom:0},"@media (max-width: 640px)":{fontSize:"0.8rem"}},enemyShips:{display:"grid",gridTemplateColumns:"100%",gridTemplateRows:"repeat(6, 1fr)","@media (max-width: 640px)":{gridTemplateColumns:"1fr 1fr",gridTemplateRows:"repeat(3, 1fr)"}},enemyShip:{border:"2px solid black",color:"#ccc",fontFamily:"sans-serif",fontSize:"1.2rem",position:"relative",padding:4,margin:{top:5},"@media (max-width: 640px)":{fontSize:"0.6rem",padding:2}},enemyShipSunk:{border:"2px solid red","&:after":{width:"100%",height:"100%",display:"inline-block",position:"absolute",top:0,left:0,content:'""',background:"linear-gradient(10deg, transparent 47%, red 47%, red 53%, transparent 53%), linear-gradient(170deg, transparent 47%, red 47%, red 53%, transparent 53%)"}},fire:{border:"2px solid #ccc",cursor:"pointer",color:"white",fontSize:"1.5rem",textShadow:"1px 1px 0 black",background:"radial-gradient(#ff8000, #ff0000)",textTransform:"uppercase","&:hover":{background:"radial-gradient(#ffa447, #ff4747)"},"&:disabled":{color:"#aaa",background:"#777",cursor:"default"}}});function Ye(t){const[e,i]=u.exports.useState(void 0),[n,s]=u.exports.useState(0),[o,r]=u.exports.useState(void 0),[a,g]=u.exports.useState(!1),h=We();u.exports.useEffect(()=>{const f=k=>{var ee;i(R(O({},k),{ownMarkers:k.ownMarkers.slice(0),opponentMarkers:k.opponentMarkers.slice(0),ownShips:k.ownShips.slice(0),isOwnTurn:k.isOwnTurn,sunkEnemies:k.sunkEnemies.slice(0)}));let G=0;k.gameWon||k.gameLost?G=3:((ee=k.ownShips)==null?void 0:ee.length)&&(k.opponentShipsPlaced?G=2:G=1),s(G)};return t.gameInterface.onStateChange(f),()=>{t.gameInterface.offStateChange(f)}},[t.gameInterface,e]);const l=f=>{t.gameInterface.setShips(f)},d=f=>!(e==null?void 0:e.ownMarkers.some(k=>I(f,k))),m=(e==null?void 0:e.isOwnTurn)&&n===2,S=f=>{m&&d(f)&&r(f)},w=f=>m&&d(f)?"orange":void 0,L=()=>{o&&d(o)&&(t.gameInterface.fireShot(o),r(void 0))},D=()=>{g(!0)},W=()=>{t.gameInterface.leaveGame(),t.onExit()},x=()=>{g(!1)},b=e==null?void 0:e.opponentMarkers[(e==null?void 0:e.opponentMarkers.length)-1];let H;n===2?H=(e==null?void 0:e.isOwnTurn)?"Take your shot":"Enemy's turn":n===3?(e==null?void 0:e.opponentLeft)?H="Your opponent left":H=`You have ${(e==null?void 0:e.gameWon)?"Won":"Lost"}`:n===1&&(H="Enemy placing ships");let Y;(e==null?void 0:e.gameWon)?Y=e.ownMarkers.filter(f=>f.type===N.Hit).map(f=>({x:f.x,y:f.y,style:"red"})):o&&(Y=[{x:o.x,y:o.y,style:"red"}]);let $;return(e==null?void 0:e.gameWon)?$="rgba(0, 255, 0, 0.3)":(e==null?void 0:e.gameLost)&&($="rgba(255, 0, 0, 0.3)"),y(A,{children:[a&&c(Ve,{text:"Are you sure you want to end the game?",onOk:W,onCancel:x}),c("button",{className:h.menuButton,onClick:D,children:"Menu"}),n===0?c(Ae,{gameSettings:t.gameSettings,onShipsPlaced:l}):y("div",{className:h.wrapper,children:[c(_,{gridSize:t.gameSettings.gridSize,ships:e==null?void 0:e.ownShips,markers:e==null?void 0:e.opponentMarkers,highlightTiles:b?[{x:b.x,y:b.y,style:"orange"}]:void 0,gridArea:"friend",overlayStyle:$}),c(_,{gridSize:t.gameSettings.gridSize,ships:e==null?void 0:e.opponentShips,markers:e==null?void 0:e.ownMarkers,onSelectTile:S,highlightTiles:Y,mouseHighlightStyle:w,gridArea:"enemy",overlayStyle:$}),y("div",{className:h.statusPanel,children:[H&&c("p",{className:h.info,children:H}),n!==1&&y(A,{children:[c("p",{className:h.enemyShipHeader,children:"Enemy Ships"}),y("div",{className:h.enemyShips,children:[t.gameSettings.ships.map(f=>y("div",{className:`${h.enemyShip} ${(e==null?void 0:e.sunkEnemies.indexOf(f.id))!==-1?h.enemyShipSunk:""}`,children:[f.name," (",f.size,")"]},f.id)),n===2&&c("button",{className:h.fire,onClick:L,disabled:!o||!(e==null?void 0:e.isOwnTurn),children:"Fire"})]})]})]})]})]})}const se={gridSize:7,ships:[{id:1,size:2,name:"Patrol Boat"},{id:2,size:3,name:"Destroyer"},{id:3,size:3,name:"Submarine"},{id:4,size:4,name:"Battleship"},{id:5,size:5,name:"Aircraft Carrier"}]},Xe=C({container:{backgroundColor:"#022866",width:"100%",height:"100%",overflow:"auto"}});function je(){const[t,e]=u.exports.useState(null),[i,n]=u.exports.useState(!1),[s,o]=u.exports.useState(void 0),r=Xe();u.exports.useEffect(()=>{const h=ge();o(h),h.on("connect",()=>{n(!0)})},[]);const a=h=>{e(h)},g=()=>{e(null)};return c("div",{className:r.container,children:t?c(Ye,{gameInterface:t,gameSettings:se,onExit:g}):c(Me,{onNewGame:a,gameSettings:se,socket:s,isConnected:i})})}ue.render(c(me.StrictMode,{children:c(je,{})}),document.getElementById("root"));
